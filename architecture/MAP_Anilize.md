# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã –¥–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–î–∞—Ç–∞:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## 1. –§–∏–ª–æ—Å–æ—Ñ–∏—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏

### 1.1 –ü—Ä–∏–Ω—Ü–∏–ø —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏

–°–∏—Å—Ç–µ–º–∞ –∫–∞—Ä—Ç—ã –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è **–ª—é–±—ã—Ö** –º–∞—Ä—à—Ä—É—Ç–æ–≤ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–∏–º–µ—Ä–∞–º:

- **–õ—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤** ‚Äî –æ—Ç 1 (–ø—Ä—è–º–æ–π –º–∞—Ä—à—Ä—É—Ç) –¥–æ N (—Å–ª–æ–∂–Ω—ã–µ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏)
- **–õ—é–±—ã–µ —Ç–∏–ø—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞** ‚Äî —Å–∞–º–æ–ª—ë—Ç, –ø–æ–µ–∑–¥, –∞–≤—Ç–æ–±—É—Å, –ø–∞—Ä–æ–º, —Ç–∞–∫—Å–∏, –≤–æ–¥–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π
- **–õ—é–±—ã–µ –≥–æ—Ä–æ–¥–∞** ‚Äî –∏–∑ unified reference, —Ä–µ–∞–ª—å–Ω—ã–µ –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- **–õ—é–±—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π** ‚Äî –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫, –Ø–∫—É—Ç—Å–∫ ‚Üí –û–ª—ë–∫–º–∏–Ω—Å–∫, –ª—é–±–æ–π –≥–æ—Ä–æ–¥ ‚Üí –ª—é–±–æ–π –≥–æ—Ä–æ–¥
- **–õ—é–±—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏** ‚Äî –ø–µ—Ä–µ—Å–∞–¥–∫–∏, —Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏
- **–õ—é–±—ã–µ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏** ‚Äî —Å–∞–º–æ–ª—ë—Ç + —Ç–∞–∫—Å–∏, –ø–æ–µ–∑–¥ + –∞–≤—Ç–æ–±—É—Å, –ª—é–±–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è

### 1.2 –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–Ω–∞–µ—Ç –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö –∏–ª–∏ –º–∞—Ä—à—Ä—É—Ç–∞—Ö. –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è–º–∏:
- **Stop** ‚Äî –ª—é–±–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
- **Segment** ‚Äî –ª—é–±–æ–π —Å–µ–≥–º–µ–Ω—Ç –º–µ–∂–¥—É –¥–≤—É–º—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏
- **Route** ‚Äî –ª—é–±–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- **TransportType** ‚Äî –ª—é–±–æ–π —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏–∑ enum

### 1.3 –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏
- –ü–æ–¥–∫–ª—é—á–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã (Yandex, Leaflet, Google)
- –†–∞—Å—à–∏—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–æ–±—ã—Ç–∏—è, –ø–æ–≥–æ–¥–∞)
- –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –±–æ–ª—å—à–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–æ–≤

---

## 2. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∫–∞—Ä—Ç—ã

### 2.1 –û–±—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞

**–®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞**
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É—á–∞–µ—Ç `IBuiltRoute` –æ—Ç backend API
- –ú–∞—Ä—à—Ä—É—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Å—Å–∏–≤ `segments` –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã
- –ö–∞–∂–¥—ã–π —Å–µ–≥–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `fromStopId` –∏ `toStopId`

**–®–∞–≥ 2: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏**
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ `segment.fromStopId` –∏ `segment.toStopId`:
  - –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (real stops –∏–ª–∏ virtual stops)
  - –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≥–æ—Ä–æ–¥–∞ –∏–∑ unified reference
  - –ï—Å–ª–∏ –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (—Ü–µ–Ω—Ç—Ä —Ä–µ–≥–∏–æ–Ω–∞)

**–®–∞–≥ 3: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–π**
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–ª–∏–ª–∏–Ω–∏–∏:
  - **PLANE** ‚Üí Great Circle (–¥—É–≥–∞ –ø–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ó–µ–º–ª–∏)
  - **TRAIN, BUS, TAXI** ‚Üí Straight line (–ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è) –∏–ª–∏ –±—É–¥—É—â–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π
  - **FERRY, WATER** ‚Üí Straight line (–ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è) –∏–ª–∏ –±—É–¥—É—â–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–æ–¥–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
  - **UNKNOWN** ‚Üí Straight line (–ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è)

**–®–∞–≥ 4: –†–∞—Å—á—ë—Ç –≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã**
- –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- –ù–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è latitude –∏ longitude
- –î–æ–±–∞–≤–ª—è–µ–º padding (10-15% —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã) –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –í–æ–∑–≤—Ä–∞—â–∞–µ–º bounds –æ–±—ä–µ–∫—Ç

**–®–∞–≥ 5: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤**
- **Start marker** ‚Äî –ø–µ—Ä–≤–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
- **End marker** ‚Äî –ø–æ—Å–ª–µ–¥–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
- **Transfer markers** ‚Äî –≤—Å–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–≥–¥–µ `toStop` –æ–¥–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ = `fromStop` —Å–ª–µ–¥—É—é—â–µ–≥–æ)
- **Segment markers** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏

**–®–∞–≥ 6: –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤**
- –ö–∞–∂–¥—ã–π —Å–µ–≥–º–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `transportType`
- –ö–∞–∂–¥—ã–π —Å–µ–≥–º–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –∏–∫–æ–Ω–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `transportType`
- –¢–æ–ª—â–∏–Ω–∞ –ª–∏–Ω–∏–∏ –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏–ª–∏ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å –ø—É–Ω–∫—Ç–∏—Ä–Ω—É—é –ª–∏–Ω–∏—é

**–®–∞–≥ 7: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã —Å —Ü–µ–Ω—Ç—Ä–æ–º –≤ —Ü–µ–Ω—Ç—Ä–µ bounds
- Zoom —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ–±—ã –≤–µ—Å—å –º–∞—Ä—à—Ä—É—Ç –±—ã–ª –≤–∏–¥–µ–Ω
- –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–ª–∏–ª–∏–Ω–∏–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ –º–∞—Ä–∫–µ—Ä—ã
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ª–µ–≥–µ–Ω–¥–∞ —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

### 2.2 –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

**–°–ª—É—á–∞–π 1: –ú–∞—Ä—à—Ä—É—Ç —Å –æ–¥–Ω–∏–º —Å–µ–≥–º–µ–Ω—Ç–æ–º (–ø—Ä—è–º–æ–π)**
- –û–¥–∏–Ω —Å–µ–≥–º–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –æ–¥–Ω–∞ –ø–æ–ª–∏–ª–∏–Ω–∏—è
- –î–≤–∞ –º–∞—Ä–∫–µ—Ä–∞: start –∏ end
- –ù–µ—Ç transfer markers

**–°–ª—É—á–∞–π 2: –ú–∞—Ä—à—Ä—É—Ç —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–æ–≤**
- –ö–∞–∂–¥—ã–π —Å–µ–≥–º–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–æ–ª–∏–ª–∏–Ω–∏–µ–π
- –¶–≤–µ—Ç–∞ –º–æ–≥—É—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- Transfer markers –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–æ—á–∫–∏ –ø–µ—Ä–µ—Å–∞–¥–∫–∏

**–°–ª—É—á–∞–π 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≥–æ—Ä–æ–¥–∞ –∏–∑ unified reference
- –ï—Å–ª–∏ –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Ü–µ–Ω—Ç—Ä —Ä–µ–≥–∏–æ–Ω–∞)
- –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –Ω–æ –º–∞—Ä—à—Ä—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–°–ª—É—á–∞–π 4: –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**
- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–º–µ—é—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ unified reference
- –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ú–æ–≥—É—Ç –∏–º–µ—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ (–ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è, –¥—Ä—É–≥–æ–π —Ü–≤–µ—Ç –º–∞—Ä–∫–µ—Ä–∞)

**–°–ª—É—á–∞–π 5: –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
  - –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ)
  - –£–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–π (–º–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –¥–ª—è –¥–∞–ª—ë–∫–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤)
  - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ –ø—Ä–∏ –º–∞–ª–æ–º zoom

**–°–ª—É—á–∞–π 6: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**
- –ù–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –º–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ö–∞–∂–¥—ã–π –º–∞—Ä—à—Ä—É—Ç –∏–º–µ–µ—Ç —Å–≤–æ–π —Ü–≤–µ—Ç –∏–ª–∏ —Å—Ç–∏–ª—å
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –∫–∞—Ä—Ç–∞ –ø–ª–∞–≤–Ω–æ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Backend-—á–∞—Å—Ç–∏

### 3.1 –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

Backend —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º Clean Architecture:

```
Presentation Layer (Controllers)
    ‚Üì
Application Layer (Use Cases)
    ‚Üì
Domain Layer (Entities, Interfaces)
    ‚Üë
Infrastructure Layer (Repositories, Utils)
```

### 3.2 Endpoint –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã

**–í–∞—Ä–∏–∞–Ω—Ç 1: POST `/api/v1/routes/map` (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

**–ü—Ä–∏—á–∏–Ω–∞ –≤—ã–±–æ—Ä–∞:** 
- –ú–∞—Ä—à—Ä—É—Ç —É–∂–µ –ø–æ–ª—É—á–µ–Ω –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –ø–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞
- –ù–µ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –≤ –∫—ç—à–µ –∏–ª–∏ –ë–î
- –ü—Ä–æ—â–µ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ backend (–Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç –ø–æ routeId)

**Request:**
- Body —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç `IBuiltRoute`
- –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Zod schema
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π: `routeId`, `segments`, `fromCity`, `toCity`

**Response:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Ä—Ç—ã: `RouteMapDataResponse`
- –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å–µ–≥–º–µ–Ω—Ç—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∏ –ø–æ–ª–∏–ª–∏–Ω–∏—è–º–∏
- –°–æ–¥–µ—Ä–∂–∏—Ç bounds –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç—ã
- –°–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –≤—Ä–µ–º—è, —Ü–µ–Ω–∞)

**–í–∞—Ä–∏–∞–Ω—Ç 2: GET `/api/v1/routes/:routeId/map` (–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)**

**–ü—Ä–∏—á–∏–Ω–∞ –≤—ã–±–æ—Ä–∞:**
- RESTful –ø–æ–¥—Ö–æ–¥
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ routeId
- –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–ø—Ä–æ—Å–µ

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –¢—Ä–µ–±—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ –∫—ç—à–µ/–ë–î
- –°–ª–æ–∂–Ω–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ –ø–æ routeId
- –î–ª—è MVP –∏–∑–±—ã—Ç–æ—á–Ω–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å POST –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è MVP, –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å GET –≤–∞—Ä–∏–∞–Ω—Ç —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

### 3.3 Use Case: BuildRouteMapDataUseCase

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `backend/src/application/route-builder/use-cases/BuildRouteMapDataUseCase.ts`

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `IStopRepository` ‚Äî –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
- `IBuiltRoute` ‚Äî –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–º–∞—Ä—à—Ä—É—Ç)
- –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–ª–∏–ª–∏–Ω–∏–π

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:**

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `routeId`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–∞—Å—Å–∏–≤–∞ `segments`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –º–∞—Å—Å–∏–≤ –Ω–µ –ø—É—Å—Ç–æ–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `fromStopId` –∏ `toStopId` –≤ –∫–∞–∂–¥–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ

2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö**
   - –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∫–∞—Ä—Ç—ã
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è bounds (min/max lat/lng)
   - –°–æ–∑–¥–∞–Ω–∏–µ Set –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (–∏–∑–±–µ–∂–∞–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤)

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (—Ü–∏–∫–ª)**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ `route.segments`:
     - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ `fromStopId` –∏ `toStopId`
     - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç `fromStop` —á–µ—Ä–µ–∑ repository (—Å–Ω–∞—á–∞–ª–∞ real, –ø–æ—Ç–æ–º virtual)
     - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç `toStop` —á–µ—Ä–µ–∑ repository (—Å–Ω–∞—á–∞–ª–∞ real, –ø–æ—Ç–æ–º virtual)
     - –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî fallback –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≥–æ—Ä–æ–¥–∞ –∏–∑ unified reference
     - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏–∑ `segment.transportType`
     - –í—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–ª–∏–ª–∏–Ω–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
     - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–∏ (–º–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç)
     - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ bounds (–ø—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –ø–æ–ª–∏–ª–∏–Ω–∏–∏)
     - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ transfer (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏)
     - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ `RouteSegmentMapData` —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
     - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –º–∞—Å—Å–∏–≤ —Å–µ–≥–º–µ–Ω—Ç–æ–≤

4. **–†–∞—Å—á—ë—Ç –æ–±—â–∏—Ö –≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã**
   - –ü—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º —Å–µ–≥–º–µ–Ω—Ç–∞–º –∏ –∏—Ö –ø–æ–ª–∏–ª–∏–Ω–∏—è–º
   - –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π lat/lng
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ padding (10-15% —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã)
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ `bounds`

5. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞**
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ `RouteMapDataResponse`
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π: `routeId`, `fromCity`, `toCity`, `segments`, `bounds`, `totalDistance`, `totalDuration`
   - –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –ï—Å–ª–∏ —Å–µ–≥–º–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –æ—à–∏–±–∫–∞
- –ï—Å–ª–∏ –≤—Å–µ —Å–µ–≥–º–µ–Ω—Ç—ã –ø—Ä–æ–ø—É—â–µ–Ω—ã ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞
- –ï—Å–ª–∏ –º–∞—Ä—à—Ä—É—Ç –ø—É—Å—Ç–æ–π ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### 3.4 –û–±–æ–≥–∞—â–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞):**

1. **Real Stop –∏–∑ PostgreSQL**
   - –¢–∞–±–ª–∏—Ü–∞ `stops` —Å–æ–¥–µ—Ä–∂–∏—Ç `latitude` –∏ `longitude`
   - –ó–∞–ø—Ä–æ—Å –ø–æ `stopId` —á–µ—Ä–µ–∑ `IStopRepository.findRealStopById()`
   - –°–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫

2. **Virtual Stop –∏–∑ PostgreSQL**
   - –¢–∞–±–ª–∏—Ü–∞ `virtual_stops` —Å–æ–¥–µ—Ä–∂–∏—Ç `latitude` –∏ `longitude`
   - –ó–∞–ø—Ä–æ—Å –ø–æ `stopId` —á–µ—Ä–µ–∑ `IStopRepository.findVirtualStopById()`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ real stop –Ω–µ –Ω–∞–π–¥–µ–Ω

3. **Unified Cities Reference**
   - –ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è `cityId` –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
   - –ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞ –≤ unified reference –ø–æ `cityId` –∏–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≥–æ—Ä–æ–¥–∞ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
   - Fallback –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫

4. **Default Coordinates**
   - –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –î–ª—è –Ø–∫—É—Ç–∏–∏: —Ü–µ–Ω—Ç—Ä —Ä–µ–≥–∏–æ–Ω–∞ (–ø—Ä–∏–º–µ—Ä–Ω–æ 62.0, 129.0)
   - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞, –Ω–æ –º–∞—Ä—à—Ä—É—Ç –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–æ–≥–∞—â–µ–Ω–∏—è:**

```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞:
  1. –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å fromStop –ø–æ fromStopId
     - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
     - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –∫ —à–∞–≥—É 2
  
  2. –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å virtualStop –ø–æ fromStopId
     - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
     - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –∫ —à–∞–≥—É 3
  
  3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ cityId –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–ª–∏ –∏–∑ segment
     - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è
     - –ü–æ–∏—Å–∫ –≤ unified reference
     - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≥–æ—Ä–æ–¥–∞
     - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –∫ —à–∞–≥—É 4
  
  4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ default coordinates
     - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  
  –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è toStop
```

### 3.5 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–∏–ª–∏–Ω–∏–π

**–ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –ø–æ–ª–∏–ª–∏–Ω–∏–∏:**

```
–ï—Å–ª–∏ transportType === 'PLANE':
  ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Great Circle –∞–ª–≥–æ—Ä–∏—Ç–º
  ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: from [lat, lng], to [lat, lng], steps = 50
  ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–∞—Å—Å–∏–≤ –∏–∑ 50+ —Ç–æ—á–µ–∫, –æ–±—Ä–∞–∑—É—é—â–∏—Ö –¥—É–≥—É

–ò–Ω–∞—á–µ –µ—Å–ª–∏ transportType === 'TRAIN' –∏–ª–∏ 'BUS' –∏–ª–∏ 'TAXI':
  ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Straight Line –∞–ª–≥–æ—Ä–∏—Ç–º
  ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: from [lat, lng], to [lat, lng]
  ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–∞—Å—Å–∏–≤ –∏–∑ 2 —Ç–æ—á–µ–∫ (–Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü)
  ‚Üí –í –±—É–¥—É—â–µ–º: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏

–ò–Ω–∞—á–µ –µ—Å–ª–∏ transportType === 'FERRY' –∏–ª–∏ 'WATER':
  ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Straight Line –∞–ª–≥–æ—Ä–∏—Ç–º
  ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: from [lat, lng], to [lat, lng]
  ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–∞—Å—Å–∏–≤ –∏–∑ 2 —Ç–æ—á–µ–∫
  ‚Üí –í –±—É–¥—É—â–µ–º: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–æ–¥–Ω—ã–º–∏ –ø—É—Ç—è–º–∏

–ò–Ω–∞—á–µ (UNKNOWN –∏–ª–∏ –¥—Ä—É–≥–æ–π):
  ‚Üí –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Straight Line –∞–ª–≥–æ—Ä–∏—Ç–º
  ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: from [lat, lng], to [lat, lng]
  ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–∞—Å—Å–∏–≤ –∏–∑ 2 —Ç–æ—á–µ–∫
```

**Great Circle –∞–ª–≥–æ—Ä–∏—Ç–º (—Å–ª–æ–≤–µ—Å–Ω–æ):**

1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ –≥—Ä–∞–¥—É—Å–æ–≤ –≤ —Ä–∞–¥–∏–∞–Ω—ã
2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —É–≥–ª–∞ –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏ –Ω–∞ —Å—Ñ–µ—Ä–µ (—Ñ–æ—Ä–º—É–ª–∞ Haversine)
3. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥—É–≥–∏ –Ω–∞ N —à–∞–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 50)
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞:
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π —Ç–æ—á–∫–∏ –Ω–∞ –¥—É–≥–µ
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ –≥—Ä–∞–¥—É—Å—ã
5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç [lat, lng]
6. –í–æ–∑–≤—Ä–∞—Ç –º–∞—Å—Å–∏–≤–∞

**Straight Line –∞–ª–≥–æ—Ä–∏—Ç–º (—Å–ª–æ–≤–µ—Å–Ω–æ):**

1. –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –∏–∑ –¥–≤—É—Ö —Ç–æ—á–µ–∫: [from, to]
2. –í–æ–∑–≤—Ä–∞—Ç –º–∞—Å—Å–∏–≤–∞

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤:**

- –ï—Å–ª–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ > 1000 –∫–º:
  - –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –¥–ª—è Great Circle (–¥–æ 100)
  - –î–ª—è Straight Line –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

- –ï—Å–ª–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ < 10 –∫–º:
  - –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –¥–ª—è Great Circle (–¥–æ 10)
  - Straight Line –æ—Å—Ç–∞—ë—Ç—Å—è –∏–∑ 2 —Ç–æ—á–µ–∫

### 3.6 –†–∞—Å—á—ë—Ç bounds (–≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**
   - `minLat = Infinity`
   - `maxLat = -Infinity`
   - `minLng = Infinity`
   - `maxLng = -Infinity`

2. **–ü—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º —Å–µ–≥–º–µ–Ω—Ç–∞–º**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ –º–∞—Ä—à—Ä—É—Ç–µ:
     - –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –ø–æ–ª–∏–ª–∏–Ω–∏–∏ —Å–µ–≥–º–µ–Ω—Ç–∞:
       - `minLat = Math.min(minLat, coordinate[0])`
       - `maxLat = Math.max(maxLat, coordinate[0])`
       - `minLng = Math.min(minLng, coordinate[1])`
       - `maxLng = Math.max(maxLng, coordinate[1])`

3. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ padding**
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–Ω–∏—Ü—ã: `latDiff = maxLat - minLat`, `lngDiff = maxLng - minLng`
   - Padding –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: `padding = 0.15` (15%)
   - `minLat = minLat - (latDiff * padding)`
   - `maxLat = maxLat + (latDiff * padding)`
   - `minLng = minLng - (lngDiff * padding)`
   - `maxLng = maxLng + (lngDiff * padding)`

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤**
   - –ï—Å–ª–∏ –≤—Å–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã (–æ–¥–Ω–∞ —Ç–æ—á–∫–∞):
     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π padding: ¬±0.1 –≥—Ä–∞–¥—É—Å–∞
   - –ï—Å–ª–∏ –º–∞—Ä—à—Ä—É—Ç –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç 180-–π –º–µ—Ä–∏–¥–∏–∞–Ω (International Date Line):
     - –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –ï—Å–ª–∏ –º–∞—Ä—à—Ä—É—Ç –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –ø–æ–ª—é—Å–∞:
     - –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –ø–æ–ª—è—Ä–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤

5. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ bounds –æ–±—ä–µ–∫—Ç–∞**
   - `bounds = { north: maxLat, south: minLat, east: maxLng, west: minLng }`
   - –í–æ–∑–≤—Ä–∞—Ç bounds

### 3.7 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞

**RouteMapDataResponse:**

```
{
  routeId: string                    // ID –º–∞—Ä—à—Ä—É—Ç–∞
  fromCity: string                   // –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  toCity: string                     // –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
  segments: RouteSegmentMapData[]    // –ú–∞—Å—Å–∏–≤ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
  bounds: {
    north: number                    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–æ—Ç–∞
    south: number                    // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–æ—Ç–∞
    east: number                     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ª–≥–æ—Ç–∞
    west: number                     // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ª–≥–æ—Ç–∞
  }
  totalDistance: number              // –û–±—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–º
  totalDuration: number             // –û–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–Ω—É—Ç–∞—Ö
}
```

**RouteSegmentMapData:**

```
{
  segmentId: string                  // ID —Å–µ–≥–º–µ–Ω—Ç–∞
  transportType: TransportType       // –¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
  fromStop: {
    id: string                       // ID –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
    name: string                     // –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
    latitude: number                 // –®–∏—Ä–æ—Ç–∞
    longitude: number                // –î–æ–ª–≥–æ—Ç–∞
    cityName: string                 // –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
    isTransfer: boolean              // –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–µ—Ä–µ—Å–∞–¥–∫–æ–π
  }
  toStop: {
    id: string
    name: string
    latitude: number
    longitude: number
    cityName: string
    isTransfer: boolean
  }
  polyline: {
    coordinates: [number, number][]  // –ú–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç [lat, lng]
  }
  distance: number                   // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ –∫–º
  duration: number                   // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö
  price: number                      // –¶–µ–Ω–∞ —Å–µ–≥–º–µ–Ω—Ç–∞
  departureTime: string              // –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  arrivalTime: string                // –í—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è
}
```

### 3.8 –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª–∏–ª–∏–Ω–∏—è–º–∏

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `backend/src/shared/utils/polyline-builder.ts`

**–§—É–Ω–∫—Ü–∏–∏:**

1. **buildGreatCirclePolyline(from, to, steps)**
   - –í—Ö–æ–¥: –¥–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã [lat, lng], –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤
   - –í—ã—Ö–æ–¥: –º–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç [lat, lng][]
   - –ê–ª–≥–æ—Ä–∏—Ç–º: —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø–æ –¥—É–≥–µ –±–æ–ª—å—à–æ–≥–æ –∫—Ä—É–≥–∞

2. **buildStraightPolyline(from, to)**
   - –í—Ö–æ–¥: –¥–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã [lat, lng]
   - –í—ã—Ö–æ–¥: –º–∞—Å—Å–∏–≤ –∏–∑ –¥–≤—É—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç [lat, lng][]
   - –ê–ª–≥–æ—Ä–∏—Ç–º: –ø—Ä—è–º–∞—è –ª–∏–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏

3. **encodePolyline(coordinates)** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –í—Ö–æ–¥: –º–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç [lat, lng][]
   - –í—ã—Ö–æ–¥: –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (Google/Yandex —Ñ–æ—Ä–º–∞—Ç)
   - –ê–ª–≥–æ—Ä–∏—Ç–º: –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

4. **calculateDistance(from, to)**
   - –í—Ö–æ–¥: –¥–≤–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã [lat, lng]
   - –í—ã—Ö–æ–¥: —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
   - –ê–ª–≥–æ—Ä–∏—Ç–º: —Ñ–æ—Ä–º—É–ª–∞ Haversine

### 3.9 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IStopRepository:**
- `findRealStopById(stopId)` ‚Äî –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
- `findVirtualStopById(stopId)` ‚Äî –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
- `getRealStopsByCityName(cityName)` ‚Äî –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –≥–æ—Ä–æ–¥—É (fallback)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Unified Cities Reference:**
- –ß–µ—Ä–µ–∑ `unified-cities-loader.ts`
- –§—É–Ω–∫—Ü–∏—è `getUnifiedCity(cityName)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≥–æ—Ä–æ–¥–∞
- Fallback –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∏–ø–æ–≤:**
- `IBuiltRoute` –∏–∑ `domain/entities/BuiltRoute.ts`
- `IRouteSegmentDetails` –∏–∑ `domain/entities/BuiltRoute.ts`
- `TransportType` –∏–∑ `domain/entities/RouteSegment.ts`

---

## 4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Frontend-—á–∞—Å—Ç–∏

### 4.1 –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è route-map

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/`

**–ü—Ä–∏–Ω—Ü–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:** Feature-Based Architecture

```
route-map/
‚îú‚îÄ‚îÄ ui/                          # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ route-map.tsx            # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ route-map-segment.tsx    # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–µ–≥–º–µ–Ω—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ route-map-marker.tsx     # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–∞—Ä–∫–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ route-map-popup.tsx      # Popup —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ route-map-controls.tsx  # –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ route-map-legend.tsx    # –õ–µ–≥–µ–Ω–¥–∞ —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                 # –≠–∫—Å–ø–æ—Ä—Ç—ã
‚îú‚îÄ‚îÄ hooks/                        # React —Ö—É–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ use-route-map-data.ts    # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ use-route-map-bounds.ts  # –†–∞—Å—á—ë—Ç –≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ use-route-map-segments.ts # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ lib/                          # –£—Ç–∏–ª–∏—Ç—ã –∏ –∞–¥–∞–ø—Ç–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ map-data-adapter.ts      # –ê–¥–∞–ø—Ç–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ map-styles.ts            # –°—Ç–∏–ª–∏ –∏ —Ü–≤–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ marker-generator.ts      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ providers/                    # –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∫–∞—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ map-provider.tsx         # –ü—Ä–æ–≤–∞–π–¥–µ—Ä –¥–ª—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ types.ts                      # TypeScript —Ç–∏–ø—ã
‚îî‚îÄ‚îÄ index.ts                      # –ü—É–±–ª–∏—á–Ω—ã–π API –º–æ–¥—É–ª—è
```

### 4.2 –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É Yandex Maps –∏ Leaflet –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:** –ü–∞—Ç—Ç–µ—Ä–Ω Strategy —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IMapProvider`.

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å IMapProvider:**

```
IMapProvider {
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
  initializeMap(containerId, options) ‚Üí MapInstance
  
  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–∏
  addPolyline(mapInstance, coordinates, style) ‚Üí PolylineInstance
  
  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–∞
  addMarker(mapInstance, position, options) ‚Üí MarkerInstance
  
  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã
  setBounds(mapInstance, bounds) ‚Üí void
  
  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–Ω—Ç—Ä–∞ –∏ zoom
  setCenterAndZoom(mapInstance, center, zoom) ‚Üí void
  
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
  onPolylineClick(polylineInstance, callback) ‚Üí void
  onMarkerClick(markerInstance, callback) ‚Üí void
  
  // –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  removePolyline(polylineInstance) ‚Üí void
  removeMarker(markerInstance) ‚Üí void
  clearMap(mapInstance) ‚Üí void
}
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

1. **YandexMapProvider** ‚Äî –¥–ª—è Yandex Maps API
2. **LeafletMapProvider** ‚Äî –¥–ª—è Leaflet + OpenStreetMap
3. **GoogleMapProvider** ‚Äî –¥–ª—è Google Maps (–±—É–¥—É—â–µ–µ)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `RouteMap` –ø–æ–ª—É—á–∞–µ—Ç `IMapProvider` —á–µ—Ä–µ–∑ props –∏–ª–∏ context
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–∞—Ä—Ç–æ–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –õ–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 4.3 –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç RouteMap

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –º–∞—Ä—à—Ä—É—Ç–∞
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∞—Ä–∫–µ—Ä–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ zoom –∏ bounds
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (–∫–ª–∏–∫–∏, –Ω–∞–≤–µ–¥–µ–Ω–∏–µ)

**Props:**

```
interface RouteMapProps {
  route: IBuiltRoute | null          // –ú–∞—Ä—à—Ä—É—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
  mapData?: RouteMapData | null      // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  isLoading?: boolean                // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
  onSegmentClick?: (segmentId: string) => void  // Callback –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç
  onMarkerClick?: (markerId: string) => void    // Callback –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –º–∞—Ä–∫–µ—Ä
  mapProvider?: IMapProvider         // –ü—Ä–æ–≤–∞–π–¥–µ—Ä –∫–∞—Ä—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
  className?: string                 // CSS –∫–ª–∞—Å—Å—ã
  height?: string                    // –í—ã—Å–æ—Ç–∞ –∫–∞—Ä—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 600px)
  showLegend?: boolean               // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –ª–µ–≥–µ–Ω–¥—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true)
  showControls?: boolean             // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true)
}
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞:**

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—É–∫–∞ `useRouteMapData(route)` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
   - –ï—Å–ª–∏ `mapData` –ø–µ—Ä–µ–¥–∞–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–Ω, –∏–Ω–∞—á–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—É–∫–∞ `useRouteMapBounds(segments)` –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –≥—Ä–∞–Ω–∏—Ü

2. **–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–µ–≥–º–µ–Ω—Ç–æ–≤**
   - –ü—Ä–æ—Ö–æ–¥ –ø–æ –º–∞—Å—Å–∏–≤—É `mapData.segments`
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞:
     - –í—ã–∑–æ–≤ `mapProvider.addPolyline()` —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∏–∑ `segment.polyline.coordinates`
     - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `segment.transportType`
     - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ —á–µ—Ä–µ–∑ `mapProvider.onPolylineClick()`

3. **–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–∞—Ä–∫–µ—Ä–æ–≤**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `generateMapMarkers(mapData)` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∞—Ä–∫–µ—Ä–æ–≤
   - –ü—Ä–æ—Ö–æ–¥ –ø–æ –º–∞—Å—Å–∏–≤—É –º–∞—Ä–∫–µ—Ä–æ–≤
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä–∫–µ—Ä–∞:
     - –í—ã–∑–æ–≤ `mapProvider.addMarker()` —Å –ø–æ–∑–∏—Ü–∏–µ–π –∏ –æ–ø—Ü–∏—è–º–∏
     - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ —á–µ—Ä–µ–∑ `mapProvider.onMarkerClick()`

4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ–π**
   - –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö: –≤—ã–∑–æ–≤ `mapProvider.setBounds()` —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ bounds
   - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–∞—Ä—à—Ä—É—Ç–∞: –æ—á–∏—Å—Ç–∫–∞ –∫–∞—Ä—Ç—ã –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞
   - –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç: –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª—è)

5. **–û—á–∏—Å—Ç–∫–∞**
   - –ü—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–∏–ª–∏–Ω–∏–π –∏ –º–∞—Ä–∫–µ—Ä–æ–≤
   - –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–∞—Ä—Ç—ã

### 4.4 –•—É–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–æ–π

**useRouteMapData (–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö)**

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/hooks/use-route-map-data.ts`

**–õ–æ–≥–∏–∫–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç React Query –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `IBuiltRoute` –∏–ª–∏ `routeId`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/v1/routes/map` —Å —Ç–µ–ª–æ–º `{ route }`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ data, isLoading, error }`
- –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ `routeId` –Ω–∞ 5 –º–∏–Ω—É—Ç

**useRouteMapBounds (—Ä–∞—Å—á—ë—Ç –≥—Ä–∞–Ω–∏—Ü)**

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/hooks/use-route-map-bounds.ts`

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å –ø–æ–ª–∏–ª–∏–Ω–∏—è–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `useMemo` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –≤—Å–µ—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- –ù–∞—Ö–æ–¥–∏—Ç min/max lat/lng
- –î–æ–±–∞–≤–ª—è–µ—Ç padding (15%)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `MapBounds | null`

**useRouteMapSegments (–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤)**

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/hooks/use-route-map-segments.ts`

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `RouteMapData`
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–µ–≥–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ —Ç–∏–ø—É —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ (–¥–ª—è –ª–µ–≥–µ–Ω–¥—ã)
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (–¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

### 4.5 –ê–¥–∞–ø—Ç–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/lib/map-data-adapter.ts`

**–§—É–Ω–∫—Ü–∏—è adaptRouteToMapData:**

**–í—Ö–æ–¥:** `IBuiltRoute` –∏ `RouteMapDataResponse` (–æ—Ç API)

**–í—ã—Ö–æ–¥:** `RouteMapData` (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç)

**–õ–æ–≥–∏–∫–∞:**
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –∫–∞—Ä—Ç—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
- –û–±–æ–≥–∞—â–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (—Ü–≤–µ—Ç, –∏–∫–æ–Ω–∫–∞, label)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–§—É–Ω–∫—Ü–∏—è generateMapMarkers:**

**–í—Ö–æ–¥:** `RouteMapData`

**–í—ã—Ö–æ–¥:** `MapMarker[]`

**–õ–æ–≥–∏–∫–∞:**
1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Å—Ç–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤
2. –°–æ–∑–¥–∞–Ω–∏–µ Set –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
3. –ü—Ä–æ—Ö–æ–¥ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º:
   - –ü–µ—Ä–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ start marker –¥–ª—è `fromStop`
   - –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ end marker –¥–ª—è `toStop`
   - –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã: –ø—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ `fromStop` transfer (–µ—Å–ª–∏ `toStop` –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ = `fromStop` —Ç–µ–∫—É—â–µ–≥–æ)
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ transfer marker –¥–ª—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
4. –í–æ–∑–≤—Ä–∞—Ç –º–∞—Å—Å–∏–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤

**–ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è transfer:**

```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (–Ω–∞—á–∏–Ω–∞—è —Å–æ –≤—Ç–æ—Ä–æ–≥–æ):
  fromStopId = —Ç–µ–∫—É—â–∏–π_—Å–µ–≥–º–µ–Ω—Ç.fromStop.id
  previousToStopId = –ø—Ä–µ–¥—ã–¥—É—â–∏–π_—Å–µ–≥–º–µ–Ω—Ç.toStop.id
  
  –ï—Å–ª–∏ fromStopId === previousToStopId:
    ‚Üí –≠—Ç–æ transfer —Ç–æ—á–∫–∞
    ‚Üí –î–æ–±–∞–≤–∏—Ç—å transfer marker
  –ò–Ω–∞—á–µ:
    ‚Üí –≠—Ç–æ –Ω–µ transfer (–≤–æ–∑–º–æ–∂–Ω–æ, –æ—à–∏–±–∫–∞ –≤ –¥–∞–Ω–Ω—ã—Ö)
    ‚Üí –î–æ–±–∞–≤–∏—Ç—å –æ–±—ã—á–Ω—ã–π marker —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
```

### 4.6 –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/lib/map-styles.ts`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

1. **TRANSPORT_COLORS** ‚Äî –æ–±—ä–µ–∫—Ç —Å —Ü–≤–µ—Ç–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
2. **TRANSPORT_ICONS** ‚Äî –æ–±—ä–µ–∫—Ç —Å –∏–∫–æ–Ω–∫–∞–º–∏ (emoji –∏–ª–∏ URL)
3. **TRANSPORT_LABELS** ‚Äî –æ–±—ä–µ–∫—Ç —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
4. **–§—É–Ω–∫—Ü–∏–∏-–≥–µ—Ç—Ç–µ—Ä—ã:**
   - `getTransportColor(transportType)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞
   - `getTransportIcon(transportType)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏
   - `getTransportLabel(transportType)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è

**–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å:**
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –æ–±—ä–µ–∫—Ç—ã
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ props –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ URL

### 4.7 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `frontend/src/modules/routes/features/route-map/lib/marker-generator.ts`

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤:**

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**
   - –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤
   - –°–æ–∑–¥–∞–Ω–∏–µ Set –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (–ø–æ ID)

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞**
   - `fromStop` –ø–µ—Ä–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ ‚Üí **Start Marker**
   - –¢–∏–ø: `'start'`
   - –¶–≤–µ—Ç: –∑–µ–ª—ë–Ω—ã–π (#00CC66)
   - –ò–∫–æ–Ω–∫–∞: üìç –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω–∞—è
   - Z-index: 1000 (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Set

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (–∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ):
     - –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ `fromStop` transfer —Ç–æ—á–∫–æ–π
     - –ï—Å–ª–∏ –¥–∞ ‚Üí **Transfer Marker**
     - –¢–∏–ø: `'transfer'`
     - –¶–≤–µ—Ç: —Å–µ—Ä—ã–π (#999999)
     - –ò–∫–æ–Ω–∫–∞: üîÑ –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω–∞—è
     - Z-index: 500 (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
     - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Set

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞**
   - `toStop` –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ ‚Üí **End Marker**
   - –¢–∏–ø: `'end'`
   - –¶–≤–µ—Ç: –∫—Ä–∞—Å–Ω—ã–π (#FF0000)
   - –ò–∫–æ–Ω–∫–∞: üèÅ –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω–∞—è
   - Z-index: 1000 (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ Set

5. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Segment Markers**
   - –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è:
     - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –º–∞—Ä–∫–µ—Ä—ã –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞
     - –¢–∏–ø: `'segment-start'` –∏ `'segment-end'`
     - –¶–≤–µ—Ç: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
     - Z-index: 300 (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

6. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ä–∞**
   - Start: "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: {–Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏} –≤ {–≤—Ä–µ–º—è}"
   - Transfer: "–ü–µ—Ä–µ—Å–∞–¥–∫–∞: {–Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏} –≤ {–≤—Ä–µ–º—è}"
   - End: "–ü—Ä–∏–±—ã—Ç–∏–µ: {–Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏} –≤ {–≤—Ä–µ–º—è}"

7. **–í–æ–∑–≤—Ä–∞—Ç –º–∞—Å—Å–∏–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤**

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:**
- –ï—Å–ª–∏ –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–∞—Ö)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Set –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –º–∞—Ä–∫–µ—Ä (–ø–µ—Ä–≤—ã–π –≤—Å—Ç—Ä–µ—á–µ–Ω–Ω—ã–π)

### 4.8 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Yandex Maps

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `@pbe/react-yandex-maps` ‚Äî React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è Yandex Maps
- `yandex-maps` ‚Äî –±–∞–∑–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `<YMaps>` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∫–∞—Ä—Ç—É
- –¢—Ä–µ–±—É–µ—Ç—Å—è API –∫–ª—é—á –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `<Map>` —Å–æ–∑–¥–∞—ë—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–∞—Ä—Ç—ã
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `<Polyline>` –∏ `<Placemark>` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–∞—Ç–∏–≤–Ω—ã–π React-–ø–æ–¥—Ö–æ–¥
- –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª–∏–ª–∏–Ω–∏–π –∏ –º–∞—Ä–∫–µ—Ä–æ–≤
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–±—ã—Ç–∏–π
- –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 4.9 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Leaflet

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `leaflet` ‚Äî –±–∞–∑–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- `react-leaflet` ‚Äî React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `@types/leaflet` ‚Äî TypeScript —Ç–∏–ø—ã

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–∞—Ä—Ç—ã —á–µ—Ä–µ–∑ `L.map(containerId)`
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ tile layer (OpenStreetMap)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `L.polyline()` –¥–ª—è –ø–æ–ª–∏–ª–∏–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `L.marker()` –¥–ª—è –º–∞—Ä–∫–µ—Ä–æ–≤

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–∞—Ä—Ç–æ–π
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–∞
- –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π
- –ë–æ–ª—å—à–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è

### 4.10 –°–≤—è–∑—å –∫–∞—Ä—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:**

1. **–ò–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª–µ–π –º–∞—Ä—à—Ä—É—Ç–∞**
   - –ú–∞—Ä—à—Ä—É—Ç —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ `useRoutesSearch`
   - –ü–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `RouteMap` –∫–∞–∫ prop
   - –î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `useRouteMapData`

2. **–ò–∑ —Å–ø–∏—Å–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤**
   - –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
   - –ò–ª–∏ –∫–∞—Ä—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
   - –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é

3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - React Query –∫—ç—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –ø–æ `routeId`
   - –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–∞—Ä—Ç—ã –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫—ç—à–∞
   - –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–∞—Ä—à—Ä—É—Ç–∞

**–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**
- –ö–ª–∏–∫ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ ‚Üí –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
- –ö–ª–∏–∫ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç –Ω–∞ –∫–∞—Ä—Ç–µ ‚Üí –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ —Å–ø–∏—Å–∫–µ
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã

### 4.11 –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∏ –º–∞—Ä–∫–µ—Ä–æ–≤

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤:**

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã**
   - –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–∞—Ä—Ç—ã
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ –∏ zoom

2. **–û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤**
   - –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–∏–ª–∏–Ω–∏–π –∏ –º–∞—Ä–∫–µ—Ä–æ–≤ (–µ—Å–ª–∏ –±—ã–ª–∏)

3. **–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (—Ü–∏–∫–ª)**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ `mapData.segments`:
     - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ `segment.polyline.coordinates`
     - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ `getTransportColor(segment.transportType)`
     - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–∏ —á–µ—Ä–µ–∑ `mapProvider.addPolyline()`
     - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª—è (—Ü–≤–µ—Ç, —Ç–æ–ª—â–∏–Ω–∞, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å)
     - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞
     - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ª–∏–ª–∏–Ω–∏—é (–¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è)

4. **–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–∞—Ä–∫–µ—Ä–æ–≤ (—Ü–∏–∫–ª)**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä–∫–µ—Ä–∞ –≤ `markers`:
     - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ `[marker.position[0], marker.position[1]]`
     - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ `getTransportIcon()` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `marker.icon`
     - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ `marker.color` –∏–ª–∏ –ø–æ —Ç–∏–ø—É –º–∞—Ä–∫–µ—Ä–∞
     - –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–∞ —á–µ—Ä–µ–∑ `mapProvider.addMarker()`
     - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ü–∏–π (–∏–∫–æ–Ω–∫–∞, —Ü–≤–µ—Ç, z-index)
     - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞
     - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ popup —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (–Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –≤—Ä–µ–º—è)
     - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–∞—Ä–∫–µ—Ä (–¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è)

5. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–∞–Ω–∏—Ü –∫–∞—Ä—Ç—ã**
   - –í—ã–∑–æ–≤ `mapProvider.setBounds()` —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ bounds
   - –ò–ª–∏ –≤—ã–∑–æ–≤ `mapProvider.setCenterAndZoom()` —Å —Ü–µ–Ω—Ç—Ä–æ–º –∏ zoom
   - –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –Ω–æ–≤—ã–º –≥—Ä–∞–Ω–∏—Ü–∞–º

6. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π**
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–ª–∏–∫–∞ –Ω–∞ –ø–æ–ª–∏–ª–∏–Ω–∏–∏
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–ª–∏–∫–∞ –Ω–∞ –º–∞—Ä–∫–µ—Ä—ã
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –Ω–∞–≤–µ–¥–µ–Ω–∏—è (hover)
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞

7. **–û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏**
   - –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–∏–ª–∏–Ω–∏–π —á–µ—Ä–µ–∑ `mapProvider.removePolyline()`
   - –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ `mapProvider.removeMarker()`
   - –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–∞—Ä—Ç—ã

### 4.12 –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤.

**–ü–æ–¥—Ö–æ–¥ 1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è MVP)**

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
- –ö–Ω–æ–ø–∫–∏ "–ü—Ä–µ–¥—ã–¥—É—â–∏–π"/"–°–ª–µ–¥—É—é—â–∏–π" –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏:
  - –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—É—â–µ–π –∫–∞—Ä—Ç—ã
  - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞
  - –ü–ª–∞–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∫–∞—Ä—Ç—ã (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)

**–ü–æ–¥—Ö–æ–¥ 2: –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–¥–ª—è –±—É–¥—É—â–µ–≥–æ)**

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ö–∞–∂–¥—ã–π –º–∞—Ä—à—Ä—É—Ç –∏–º–µ–µ—Ç —Å–≤–æ–π —Ü–≤–µ—Ç –∏–ª–∏ —Å—Ç–∏–ª—å
- –õ–µ–≥–µ–Ω–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ —á–µ—Ä–µ–∑ —á–µ–∫–±–æ–∫—Å—ã
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ ‚Äî –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è:**

```typescript
const [currentRouteIndex, setCurrentRouteIndex] = useState(0);
const routes = [mainRoute, ...alternatives];

const handleNextRoute = () => {
  if (currentRouteIndex < routes.length - 1) {
    setCurrentRouteIndex(currentRouteIndex + 1);
  }
};

const handlePrevRoute = () => {
  if (currentRouteIndex > 0) {
    setCurrentRouteIndex(currentRouteIndex - 1);
  }
};

<RouteMap route={routes[currentRouteIndex]} />
```

### 4.13 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**

1. **–ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤**
   - –ü—Ä–∏ 10+ —Å–µ–≥–º–µ–Ω—Ç–∞—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
   - –†–µ—à–µ–Ω–∏–µ: –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤

2. **–°–ª–æ–∂–Ω—ã–µ –ø–æ–ª–∏–ª–∏–Ω–∏–∏**
   - Great Circle —Å 50+ —Ç–æ—á–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
   - –†–µ—à–µ–Ω–∏–µ: —É–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–π –ø—Ä–∏ –º–∞–ª–æ–º zoom

3. **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞—Ä–∫–µ—Ä–æ–≤**
   - –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
   - –†–µ—à–µ–Ω–∏–µ: –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö

4. **–ß–∞—Å—Ç—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**
   - –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ zoom
   - –†–µ—à–µ–Ω–∏–µ: debounce –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π, –º–µ–º–æ–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

1. **–ú–µ–º–æ–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `useMemo` –¥–ª—è bounds, –º–∞—Ä–∫–µ—Ä–æ–≤, —Å–µ–≥–º–µ–Ω—Ç–æ–≤
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∏–ª–µ–π –∏ —Ü–≤–µ—Ç–æ–≤

2. **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**
   - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–∞—Ä—Ç—ã
   - –û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª–µ–π –º–∞—Ä–∫–µ—Ä–æ–≤

3. **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è**
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (–≤ viewport)
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –∫–∞—Ä—Ç—ã

4. **–£–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–π**
   - –ü—Ä–∏ zoom < 5: —É–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–π (–º–µ–Ω—å—à–µ —Ç–æ—á–µ–∫)
   - –ü—Ä–∏ zoom >= 5: –ø–æ–ª–Ω–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è

5. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤**
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –±–ª–∏–∑–∫–∏—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ã
   - –ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ zoom ‚Äî —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

### 4.14 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

**–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏:**

1. **–ú–∞—Ä—à—Ä—É—Ç –±–µ–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤**
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–ú–∞—Ä—à—Ä—É—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–≥–º–µ–Ω—Ç–æ–≤"
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏

2. **–°–µ–≥–º–µ–Ω—Ç –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç**
   - –ü—Ä–æ–ø—É—Å–∫ —Å–µ–≥–º–µ–Ω—Ç–∞ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤

3. **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ fallback –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

4. **–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—ã**
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
   - –ö–Ω–æ–ø–∫–∞ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É"
   - Fallback –Ω–∞ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –º–∞—Ä–∫–µ—Ä—ã –≥–æ—Ä–æ–¥–æ–≤)

5. **–ö–∞—Ä—Ç–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è API –∫–ª—é—á–∞ (–¥–ª—è Yandex Maps)
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - Fallback –Ω–∞ Leaflet (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

6. **–û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç (—Ç—Ä–∞–Ω—Å–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–∞–ª—å–Ω—ã–π)**
   - –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ bounds
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ viewport'–æ–≤
   - –£–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–ª–∏–ª–∏–Ω–∏–π

7. **–ú–∞—Ä—à—Ä—É—Ç —Å –æ–¥–Ω–∏–º —Å–µ–≥–º–µ–Ω—Ç–æ–º**
   - –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, –Ω–æ –±–µ–∑ transfer markers
   - –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ª–µ–≥–µ–Ω–¥–∞

### 4.15 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ RouteDetailsView:**

```typescript
// frontend/src/modules/routes/features/route-details/ui/route-details-view.tsx

import { RouteMap } from '../../route-map';

export function RouteDetailsView({ data }: RouteDetailsViewProps) {
  const [showMap, setShowMap] = useState(false);
  const route = adaptRouteToDetailsFormat(data); // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ IBuiltRoute

  return (
    <div>
      {/* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç */}
      <RouteSummary data={data} />
      <RouteSegments data={data} />
      
      {/* –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è —Å –∫–∞—Ä—Ç–æ–π */}
      <div className="mt-6">
        <button onClick={() => setShowMap(!showMap)}>
          {showMap ? '–°–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É' : '–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ'}
        </button>
        
        {showMap && (
          <RouteMap 
            route={route}
            onSegmentClick={(segmentId) => {
              // –ü–æ–¥—Å–≤–µ—Ç–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ
              console.log('Segment clicked:', segmentId);
            }}
          />
        )}
      </div>
    </div>
  );
}
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ RouteListItem:**

```typescript
// frontend/src/modules/routes/features/route-list/ui/routes-section.tsx

import { RouteMap } from '../../route-map';

export function RouteListItem({ route }: { route: IBuiltRoute }) {
  const [showMap, setShowMap] = useState(false);

  return (
    <div className="route-item">
      {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ä—à—Ä—É—Ç–µ */}
      <RouteInfo route={route} />
      
      {/* –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑–∞ –∫–∞—Ä—Ç—ã */}
      <button onClick={() => setShowMap(!showMap)}>
        –ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ
      </button>
      
      {/* –ö–∞—Ä—Ç–∞ (—É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥) */}
      {showMap && (
        <div className="mt-4">
          <RouteMap route={route} height="400px" />
        </div>
      )}
    </div>
  );
}
```

### 4.16 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∫–∞—Ä—Ç—ã

**Unit —Ç–µ—Å—Ç—ã:**

1. **–¢–µ—Å—Ç—ã –∞–¥–∞–ø—Ç–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**
   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `IBuiltRoute` ‚Üí `RouteMapData`
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

2. **–¢–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç**
   - –†–∞—Å—á—ë—Ç bounds
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–∏–ª–∏–Ω–∏–π
   - –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤

3. **–¢–µ—Å—Ç—ã —Ö—É–∫–æ–≤**
   - `useRouteMapData` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
   - `useRouteMapBounds` ‚Äî —Ä–∞—Å—á—ë—Ç –≥—Ä–∞–Ω–∏—Ü
   - –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**Integration —Ç–µ—Å—Ç—ã:**

1. **–¢–µ—Å—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ RouteMap**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤

2. **–¢–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API**
   - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ API
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**E2E —Ç–µ—Å—Ç—ã:**

1. **–°—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ**
   - –ü–æ–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–∞ –ú–æ—Å–∫–≤–∞ ‚Üí –Ø–∫—É—Ç—Å–∫
   - –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞—Ä—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤

2. **–°—Ü–µ–Ω–∞—Ä–∏–π: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤**
   - –í—ã–±–æ—Ä –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## 5. –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: Backend ‚Äî –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (2-3 —á–∞—Å–∞)

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å `polyline-builder.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–ª–∏–ª–∏–Ω–∏–π
2. –°–æ–∑–¥–∞—Ç—å `BuildRouteMapDataUseCase.ts` —Å –ª–æ–≥–∏–∫–æ–π –æ–±–æ–≥–∞—â–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞
3. –°–æ–∑–¥–∞—Ç—å `RouteMapController.ts` —Å endpoint `/api/v1/routes/map`
4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–æ—É—Ç –≤ `routes/index.ts`
5. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ Zod schema

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- Endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞
- –í—Å–µ —Å–µ–≥–º–µ–Ω—Ç—ã –æ–±–æ–≥–∞—â–µ–Ω—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
- –ü–æ–ª–∏–ª–∏–Ω–∏–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Bounds —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –≠—Ç–∞–ø 2: Backend ‚Äî –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 —á–∞—Å–∞)

**–ó–∞–¥–∞—á–∏:**
1. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è `polyline-builder.ts`
2. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è `BuildRouteMapDataUseCase.ts`
3. –ù–∞–ø–∏—Å–∞—Ç—å integration —Ç–µ—Å—Ç—ã –¥–ª—è `RouteMapController.ts`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ > 80%
- –í—Å–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
- –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –≠—Ç–∞–ø 3: Frontend ‚Äî –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (1-2 —á–∞—Å–∞)

**–ó–∞–¥–∞—á–∏:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`@pbe/react-yandex-maps` –∏–ª–∏ `leaflet`)
2. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–æ–¥—É–ª—è `route-map/`
3. –°–æ–∑–¥–∞—Ç—å —Ç–∏–ø—ã `types.ts`
4. –°–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä `map-data-adapter.ts`
5. –°–æ–∑–¥–∞—Ç—å —Å—Ç–∏–ª–∏ `map-styles.ts`

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- –ú–æ–¥—É–ª—å —Å–æ–∑–¥–∞–Ω –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω
- –¢–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- –ê–¥–∞–ø—Ç–µ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –≠—Ç–∞–ø 4: Frontend ‚Äî –•—É–∫–∏ (1-2 —á–∞—Å–∞)

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å `use-route-map-data.ts` —Å React Query
2. –°–æ–∑–¥–∞—Ç—å `use-route-map-bounds.ts` —Å –º–µ–º–æ–∏–∑–∞—Ü–∏–µ–π
3. –°–æ–∑–¥–∞—Ç—å API –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
4. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- –•—É–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

### –≠—Ç–∞–ø 5: Frontend ‚Äî –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (4-6 —á–∞—Å–æ–≤)

**–ó–∞–¥–∞—á–∏:**
1. –°–æ–∑–¥–∞—Ç—å `RouteMap` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (Yandex Maps –∏–ª–∏ Leaflet)
2. –°–æ–∑–¥–∞—Ç—å `RouteMapLegend` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
3. –°–æ–∑–¥–∞—Ç—å `RouteMapControls` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
5. –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- –ö–∞—Ä—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –°–µ–≥–º–µ–Ω—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏
- –ú–∞—Ä–∫–µ—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ö–ª–∏–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

### –≠—Ç–∞–ø 6: Frontend ‚Äî –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (2-3 —á–∞—Å–∞)

**–ó–∞–¥–∞—á–∏:**
1. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `RouteMap` –≤ `RouteDetailsView`
2. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å —Å–ø–∏—Å–∫–æ–º —Å–µ–≥–º–µ–Ω—Ç–æ–≤
4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- –ö–∞—Ä—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–µ—Ç–∞–ª–µ–π
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –≠—Ç–∞–ø 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–ª–∏—Ä–æ–≤–∫–∞ (2-3 —á–∞—Å–∞)

**–ó–∞–¥–∞—á–∏:**
1. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. –ù–∞–ø–∏—Å–∞—Ç—å integration —Ç–µ—Å—Ç—ã
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏
5. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–∞—è

---

## 6. –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### Backend (–Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã)

```
backend/src/
‚îú‚îÄ‚îÄ presentation/
‚îÇ   ‚îî‚îÄ‚îÄ controllers/
‚îÇ       ‚îî‚îÄ‚îÄ RouteMapController.ts                    ‚úÖ –°–æ–∑–¥–∞—Ç—å
‚îú‚îÄ‚îÄ application/
‚îÇ   ‚îî‚îÄ‚îÄ route-builder/
‚îÇ       ‚îî‚îÄ‚îÄ use-cases/
‚îÇ           ‚îî‚îÄ‚îÄ BuildRouteMapDataUseCase.ts          ‚úÖ –°–æ–∑–¥–∞—Ç—å
‚îî‚îÄ‚îÄ shared/
    ‚îî‚îÄ‚îÄ utils/
        ‚îî‚îÄ‚îÄ polyline-builder.ts                      ‚úÖ –°–æ–∑–¥–∞—Ç—å
```

### Frontend (–Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã)

```
frontend/src/modules/routes/
‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îî‚îÄ‚îÄ route-map/                                   ‚úÖ –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å
‚îÇ       ‚îú‚îÄ‚îÄ ui/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route-map.tsx                        ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route-map-legend.tsx                ‚úÖ –õ–µ–≥–µ–Ω–¥–∞
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route-map-controls.tsx              ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îú‚îÄ‚îÄ hooks/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ use-route-map-data.ts              ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ use-route-map-bounds.ts             ‚úÖ –†–∞—Å—á—ë—Ç –≥—Ä–∞–Ω–∏—Ü
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ use-route-map-segments.ts          ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îú‚îÄ‚îÄ lib/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ map-data-adapter.ts                 ‚úÖ –ê–¥–∞–ø—Ç–µ—Ä –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ map-styles.ts                       ‚úÖ –°—Ç–∏–ª–∏
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ marker-generator.ts                 ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ       ‚îú‚îÄ‚îÄ types.ts                                 ‚úÖ –¢–∏–ø—ã
‚îÇ       ‚îî‚îÄ‚îÄ index.ts                                 ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π API
‚îî‚îÄ‚îÄ lib/
    ‚îî‚îÄ‚îÄ route-map-api.ts                            ‚úÖ API –∫–ª–∏–µ–Ω—Ç
```

---

## 7. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

‚úÖ **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞  
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** ‚Äî –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤  
‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤  
‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è unit –∏ integration —Ç–µ—Å—Ç–æ–≤  

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å –≠—Ç–∞–ø–∞ 1 (Backend ‚Äî –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞).

---

**–î–æ–∫—É–º–µ–Ω—Ç –∑–∞–≤–µ—Ä—à—ë–Ω. –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.** 