# –†–µ–∑—é–º–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –∫–∞—Ä—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–î–∞—Ç–∞:** 2025-01-27  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –∫–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç –≤ RouteDetailsView

**–ü—Ä–æ–±–ª–µ–º–∞:** `Module not found: Can't resolve '../route-map/ui'`

**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–º–µ–Ω—ë–Ω –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π
- –ò–∑–º–µ–Ω–µ–Ω–æ: `import { RouteMapSection } from '../route-map/ui';`
- –ù–∞: `import { RouteMapSection } from '@/modules/routes/features/route-map/ui';`

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-details/ui/route-details-view.tsx`

### 2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Leaflet

**–ü—Ä–æ–±–ª–µ–º–∞:** `Module not found: Can't resolve 'leaflet'`

**–†–µ—à–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `leaflet` –∏ `@types/leaflet`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ Leaflet
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ default export –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏

**–ö–æ–º–∞–Ω–¥–∞:** `npm install leaflet @types/leaflet --save-dev`

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ TypeScript

**–ü—Ä–æ–±–ª–µ–º—ã:**
- `Property 'code' does not exist on type 'Error'`
- `Module './domain' has already exported a member named 'Coordinate'`
- `'window.ymaps' is possibly 'undefined'`
- `Property 'tileLayer' does not exist on type '{}'`
- React Hook –≤—ã–∑—ã–≤–∞–ª—Å—è —É—Å–ª–æ–≤–Ω–æ

**–†–µ—à–µ–Ω–∏—è:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫ –≤ `use-routes-search.ts`
- –£–¥–∞–ª—ë–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π —ç–∫—Å–ø–æ—Ä—Ç `Coordinate` –∏–∑ `route-map.schema.ts`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `undefined` –¥–ª—è `window.ymaps`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è Leaflet –∏–º–ø–æ—Ä—Ç–∞
- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `mapData` –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `useQuery`

**–§–∞–π–ª—ã:**
- `frontend/src/modules/routes/hooks/use-routes-search.ts`
- `frontend/src/modules/routes/schemas/route-map.schema.ts`
- `frontend/src/modules/routes/lib/providers/yandex-map-provider.ts`
- `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`
- `frontend/src/modules/routes/features/route-map/hooks/use-route-map-data.ts`

### 4. –û—á–∏—â–µ–Ω –∫—ç—à Next.js

**–î–µ–π—Å—Ç–≤–∏–µ:** –£–¥–∞–ª–µ–Ω–∞ –ø–∞–ø–∫–∞ `.next` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

**–ö–æ–º–∞–Ω–¥–∞:** `Remove-Item -Recurse -Force .next`

---

## üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### ‚úÖ –°—Ç–∞—Ç—É—Å: –£–°–ü–ï–®–ù–û

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–±–æ—Ä–∫–∏:**
```
‚úì Compiled successfully
```

**–û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ):**
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (lint warnings)
- JSX accessibility –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:** 0

---

## üß™ –°–æ—Å—Ç–æ—è–Ω–∏–µ E2E —Ç–µ—Å—Ç–æ–≤

### –°—Ç–∞—Ç—É—Å: –ß–ê–°–¢–ò–ß–ù–û –†–ê–ë–û–¢–ê–ï–¢

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç

### –ü—Ä–æ–±–ª–µ–º—ã –≤ —Ç–µ—Å—Ç–∞—Ö:

#### 1. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —ç–ª–µ–º–µ–Ω—Ç—ã route-switcher

**–ü–∞–¥–∞—é—â–∏–µ —Ç–µ—Å—Ç—ã:**
- `route-map-alternatives.spec.ts` ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤ –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç —ç–ª–µ–º–µ–Ω—Ç—ã:
  - `[data-testid="route-switcher-next"]`
  - `[data-testid="route-switcher-prev"]`
  - `[data-testid="route-switcher-indicator-1"]`

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `RouteMapSwitcher` –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –Ω—É–∂–Ω—ã—Ö `data-testid` –∞—Ç—Ä–∏–±—É—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å `data-testid` –∞—Ç—Ä–∏–±—É—Ç—ã –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `RouteMapSwitcher`

#### 2. Firefox –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–û—à–∏–±–∫–∞:** `Executable doesn't exist at ...\firefox\firefox.exe`

**–ü—Ä–∏—á–∏–Ω–∞:** Playwright Firefox –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç—å `npx playwright install firefox` –∏–ª–∏ —É–±—Ä–∞—Ç—å Firefox –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### 3. Strict mode violation –≤ routes-search —Ç–µ—Å—Ç–∞—Ö

**–û—à–∏–±–∫–∞:** `getByLabel('–ö—É–¥–∞') resolved to 2 elements`

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º label

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏–ª–∏ `getByRole` —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

---

## üìã –°–ø–∏—Å–æ–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø—Ä–æ–±–ª–µ–º

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–±–ª–æ–∫–∏—Ä—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)

**–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º** ‚Äî –∫–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

### –í–∞–∂–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è)

1. **API –∫–ª—é—á Yandex Maps –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω**
   - **–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - **–î–µ–π—Å—Ç–≤–∏–µ:** –°–æ–∑–¥–∞—Ç—å `.env.local` —Å `NEXT_PUBLIC_YANDEX_MAPS_API_KEY`
   - **–í–ª–∏—è–Ω–∏–µ:** Yandex Maps –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –±–µ–∑ –∫–ª—é—á–∞

2. **E2E —Ç–µ—Å—Ç—ã —á–∞—Å—Ç–∏—á–Ω–æ –ø–∞–¥–∞—é—Ç**
   - **–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - **–î–µ–π—Å—Ç–≤–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å `data-testid` –≤ `RouteMapSwitcher`
   - **–í–ª–∏—è–Ω–∏–µ:** –ù–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤

### –°—Ä–µ–¥–Ω–∏–µ (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å)

3. **Firefox –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è Playwright**
   - **–°—Ç–∞—Ç—É—Å:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
   - **–î–µ–π—Å—Ç–≤–∏–µ:** `npx playwright install firefox` –∏–ª–∏ —É–±—Ä–∞—Ç—å –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
   - **–í–ª–∏—è–Ω–∏–µ:** –¢–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ Firefox

4. **Lint –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**
   - **–°—Ç–∞—Ç—É—Å:** –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
   - **–î–µ–π—Å—Ç–≤–∏–µ:** –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
   - **–í–ª–∏—è–Ω–∏–µ:** –ß–∏—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞

---

## ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç—ã –∫ —Ä—É—á–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–ê (—Å –æ–≥–æ–≤–æ—Ä–∫–∞–º–∏)

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ Leaflet —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ TypeScript –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**

1. **–°–æ–∑–¥–∞—Ç—å `.env.local` —Å API –∫–ª—é—á–æ–º:**
   ```env
   NEXT_PUBLIC_YANDEX_MAPS_API_KEY=–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å dev-—Å–µ—Ä–≤–µ—Ä:**
   ```bash
   npm run dev
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω:**
   - Backend –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:5000`
   - Endpoint `/api/v1/routes/map` –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ë–µ–∑ API –∫–ª—é—á–∞ Yandex Maps –∫–∞—Ä—Ç–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è (–Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Leaflet fallback)
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ E2E —Ç–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –Ω–æ —ç—Ç–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **–°–æ–∑–¥–∞—Ç—å `.env.local`** —Å API –∫–ª—é—á–æ–º Yandex Maps
2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å dev-—Å–µ—Ä–≤–µ—Ä** –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫–∞—Ä—Ç—ã
3. **–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º –∏–∑ `ROUTE_MAP_TESTING_REPORT.md`

### –ü–æ—Å–ª–µ —Ä—É—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å E2E —Ç–µ—Å—Ç—ã:**
   - –î–æ–±–∞–≤–∏—Ç—å `data-testid` –≤ `RouteMapSwitcher`
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å strict mode violations –≤ routes-search —Ç–µ—Å—Ç–∞—Ö

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Firefox –¥–ª—è Playwright** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å lint –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å |
|----------|--------|
| –ö–æ–º–ø–∏–ª—è—Ü–∏—è | ‚úÖ –£—Å–ø–µ—à–Ω–∞ |
| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |
| TypeScript –æ—à–∏–±–∫–∏ | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |
| E2E —Ç–µ—Å—Ç—ã | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç |
| –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä—É—á–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é | ‚úÖ –ì–æ—Ç–æ–≤–∞ (—Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á) |
| –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É | ‚ùå –ù–µ –≥–æ—Ç–æ–≤–∞ (—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è) |

---

**–û—Ç—á—ë—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** 2025-01-27  
**–í–µ—Ä—Å–∏—è:** 1.0






