# –§–ò–ù–ê–õ–¨–ù–´–ô –ö–û–ú–ü–õ–ï–ö–°–ù–´–ô –ê–£–î–ò–¢: –ú–æ–¥—É–ª—å Leaflet-–∫–∞—Ä—Ç—ã

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2024  
**–¢–∏–ø –∞—É–¥–∏—Ç–∞:** –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π (Production-Ready)  
**–û—Ö–≤–∞—Ç:** –ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (CSS ‚Üí –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ‚Üí invalidateSize ‚Üí setBounds ‚Üí –ø–æ–ª–∏–ª–∏–Ω–∏–∏ ‚Üí –º–∞—Ä–∫–µ—Ä—ã ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ‚Üí –æ—à–∏–±–∫–∏ ‚Üí –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

---

## –†–ï–ó–Æ–ú–ï –ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û–ï

### –°—Ç–∞—Ç—É—Å –º–æ–¥—É–ª—è

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** ‚úÖ **–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –Ω–∞ 100%**

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:**
- üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ:** 0
- üü† **–í—ã—Å–æ–∫–∏–µ:** 0
- üü° **–°—Ä–µ–¥–Ω–∏–µ:** 0
- üü¢ **–ù–∏–∑–∫–∏–µ:** 0

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 100%

---

## 1. –ü–†–û–í–ï–†–ö–ê –ó–ê–ì–†–£–ó–ö–ò CSS

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 164-213

### 1.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ CSS

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `data-–∞—Ç—Ä–∏–±—É—Ç—É` (—Å—Ç—Ä–æ–∫–∞ 173): `document.querySelector('link[data-leaflet-css]')`
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `href` (—Å—Ç—Ä–æ–∫–∞ 174): `document.querySelector('link[href="${leafletCssUrl}"]')`
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º (—Å—Ç—Ä–æ–∫–∞ 185): `doubleCheck`
- –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º (—Å—Ç—Ä–æ–∫–∏ 201-207): `finalCheck`

**–í—ã–≤–æ–¥:** –î—É–±–ª–∏–∫–∞—Ç—ã CSS –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–µ–Ω—ã. –¢—Ä–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –¥–∞–∂–µ –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

### 1.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ race-condition –º–µ–∂–¥—É CSS –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ê–Ω–∞–ª–∏–∑:**
- –≠—Ñ—Ñ–µ–∫—Ç –∑–∞–≥—Ä—É–∑–∫–∏ CSS (—Å—Ç—Ä–æ–∫–∏ 164-213) –∏–º–µ–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `[providerType]`
- –≠—Ñ—Ñ–µ–∫—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 228-439) –∏–º–µ–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `[mapProvider, showControls, providerType, isLeafletCssLoaded]`
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `isLeafletCssLoaded` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ `appendChild` (—Å—Ç—Ä–æ–∫–∏ 201-207) –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≥–æ–Ω–∫–∏

**–í—ã–≤–æ–¥:** –ì–æ–Ω–∫–∏ –º–µ–∂–¥—É –∑–∞–≥—Ä—É–∑–∫–æ–π CSS –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–µ–Ω—ã. –°—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω.

### 1.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ CSS

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ link –≤ DOM (—Å—Ç—Ä–æ–∫–∏ 173-175)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `isLeafletCssLoaded = true` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ DOM (—Å—Ç—Ä–æ–∫–∞ 212)
- –ù–µ –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ–Ω–∞–¥—ë–∂–Ω—ã–π `onload` –¥–ª—è CSS
- –†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö (Chrome, Firefox, Safari, Edge)

**–í—ã–≤–æ–¥:** –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ CSS —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö.

### 1.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ CSS –ø—Ä–∏ –æ—à–∏–±–∫–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –°–±—Ä–æ—Å `isLeafletCssLoaded` –≤ `false` –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞" (—Å—Ç—Ä–æ–∫–∞ 630)
- –≠—Ñ—Ñ–µ–∫—Ç –∑–∞–≥—Ä—É–∑–∫–∏ CSS –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `[providerType]`
- –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π (—Å—Ç—Ä–æ–∫–∏ 626-635)

**–í—ã–≤–æ–¥:** –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ CSS –ø—Ä–∏ –æ—à–∏–±–∫–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### –ò—Ç–æ–≥ –ø–æ CSS

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 2. –ü–†–û–í–ï–†–ö–ê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò –ö–ê–†–¢–´

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 228-439

### 2.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ CSS

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isLeafletCssLoaded` –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π (—Å—Ç—Ä–æ–∫–∏ 244-290)
- DOM-–ø—Ä–æ–≤–µ—Ä–∫–∞ CSS link –∫–∞–∫ fallback (—Å—Ç—Ä–æ–∫–∏ 250-260)
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ CSS —Å —Ç–∞–π–º–∞—É—Ç–æ–º 5 —Å–µ–∫—É–Ω–¥ (—Å—Ç—Ä–æ–∫–∏ 265-288)
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ CSS

**–í—ã–≤–æ–¥:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ CSS.

### 2.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π, –∑–∞–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞ providerType="leaflet"

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `providerType === 'leaflet'` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ CSS (—Å—Ç—Ä–æ–∫–∞ 166)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `providerType === 'leaflet'` –¥–ª—è –≤—ã–∑–æ–≤–∞ `invalidateSize` (—Å—Ç—Ä–æ–∫–∞ 366)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `providerType === 'leaflet'` –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è `isSizeValidated` (—Å—Ç—Ä–æ–∫–∞ 452)
- –î–ª—è –Ω–µ-Leaflet –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ `isSizeValidated` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É (—Å—Ç—Ä–æ–∫–∞ 380)

**–í—ã–≤–æ–¥:** –í—Å–µ —É—Å–ª–æ–≤–∏—è, –∑–∞–≤—è–∑–∞–Ω–Ω—ã–µ –Ω–∞ `providerType="leaflet"`, —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 2.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ª–æ–≥–∏–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: 10 –ø–æ–ø—ã—Ç–æ–∫ (—Å—Ç—Ä–æ–∫–∏ 304-320)
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏: 100ms (—Å—Ç—Ä–æ–∫–∞ 319)
- –°–±—Ä–æ—Å –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ (—Å—Ç—Ä–æ–∫–∏ 235-237)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π `initError` (—Å—Ç—Ä–æ–∫–∏ 313-315, 383-396)
- –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∞–π–º–µ—Ä–æ–≤ –≤ cleanup —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 414-437)

**–í—ã–≤–æ–¥:** –õ–æ–≥–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –ø–æ–ø—ã—Ç–∫–∞–º, —Å–±—Ä–æ—Å–∞–º —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –æ—à–∏–±–∫–∞–º.

### 2.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –≥–æ–Ω–æ–∫ –º–µ–∂–¥—É —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ê–Ω–∞–ª–∏–∑:**
- –≠—Ñ—Ñ–µ–∫—Ç –∑–∞–≥—Ä—É–∑–∫–∏ CSS (—Å—Ç—Ä–æ–∫–∏ 164-213): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `[providerType]`
- –≠—Ñ—Ñ–µ–∫—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 228-439): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `[mapProvider, showControls, providerType, isLeafletCssLoaded]`
- –°—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫: CSS –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚Üí `isLeafletCssLoaded = true` ‚Üí –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ù–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å

**–í—ã–≤–æ–¥:** –ì–æ–Ω–∫–∏ –º–µ–∂–¥—É —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–µ–Ω—ã.

### 2.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—ã–∑–æ–≤–∞ invalidateSize

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `invalidateSize()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 366-377)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–æ–π–Ω–æ–π `requestAnimationFrame` –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ (—Å—Ç—Ä–æ–∫–∏ 369-370)
- –§–ª–∞–≥ `isSizeValidated` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (—Å—Ç—Ä–æ–∫–∞ 374)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–µ—Ç–æ–¥–∞ `invalidateSize` –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º (—Å—Ç—Ä–æ–∫–∞ 371)

**–í—ã–≤–æ–¥:** –í—ã–∑–æ–≤ `invalidateSize` –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω, –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø–æ–ø—ã—Ç–æ–∫.

### –ò—Ç–æ–≥ –ø–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 3. –ü–†–û–í–ï–†–ö–ê INVALIDATESIZE

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 366-377

**–§–∞–π–ª:** `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`  
**–°—Ç—Ä–æ–∫–∏:** 598-608

### 3.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∑–æ–≤–∞ –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤–æ–π–Ω–æ–π `requestAnimationFrame` (—Å—Ç—Ä–æ–∫–∏ 369-370)
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ DOM –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω
- –í—ã–∑–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ `setIsMapReady(true)` (—Å—Ç—Ä–æ–∫–∞ 358)

**–í—ã–≤–æ–¥:** `invalidateSize` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

### 3.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞ requestAnimationFrame

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –î–≤–æ–π–Ω–æ–π `requestAnimationFrame` –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –¥–≤—É—Ö –∫–∞–¥—Ä–æ–≤ —Ä–µ–Ω–¥–µ—Ä–∞
- –≠—Ç–æ –±–æ–ª–µ–µ –Ω–∞–¥—ë–∂–Ω–æ, —á–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

**–í—ã–≤–æ–¥:** –ú–µ—Ö–∞–Ω–∏–∑–º `requestAnimationFrame` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 3.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–ª–∞–≥–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `setIsSizeValidated(true)` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ `invalidateSize()` (—Å—Ç—Ä–æ–∫–∞ 374)
- –î–ª—è –Ω–µ-Leaflet –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Ñ–ª–∞–≥ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É (—Å—Ç—Ä–æ–∫–∞ 380)
- –§–ª–∞–≥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ (—Å—Ç—Ä–æ–∫–∏ 237, 436, 628)

**–í—ã–≤–æ–¥:** –§–ª–∞–≥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 3.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –≥–æ–Ω–æ–∫ –º–µ–∂–¥—É invalidateSize –∏ setBounds

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –≠—Ñ—Ñ–µ–∫—Ç `setBounds` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `isSizeValidated` –¥–ª—è Leaflet (—Å—Ç—Ä–æ–∫–∞ 452)
- `setBounds` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `isSizeValidated = true`
- –°—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫: `invalidateSize()` ‚Üí `isSizeValidated = true` ‚Üí `setBounds()`

**–í—ã–≤–æ–¥:** –ì–æ–Ω–∫–∏ –º–µ–∂–¥—É `invalidateSize` –∏ `setBounds` –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–µ–Ω—ã.

### –ò—Ç–æ–≥ –ø–æ invalidateSize

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 4. –ü–†–û–í–ï–†–ö–ê SETBOUNDS –ò –õ–û–ì–ò–ö–ò –†–ê–°–ß–Å–¢–ê –ì–†–ê–ù–ò–¶

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 441-472

**–§–∞–π–ª:** `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`  
**–°—Ç—Ä–æ–∫–∏:** 184-299

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/hooks/use-route-map-bounds.ts`  
**–°—Ç—Ä–æ–∫–∏:** 57-93

### 4.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö bounds

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null/undefined (—Å—Ç—Ä–æ–∫–∏ 191-194)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –∏ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π (—Å—Ç—Ä–æ–∫–∏ 196-219)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–æ–º–µ—Ç—Ä–∏–∏: `north > south` –∏ `east > west` (—Å—Ç—Ä–æ–∫–∏ 221-236)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ bounds (—Å—Ç—Ä–æ–∫–∏ 263-278)
- Fallback –Ω–∞ `setCenter()` –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö bounds

**–í—ã–≤–æ–¥:** –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö bounds –ø–æ–ª–Ω–∞—è –∏ –Ω–∞–¥—ë–∂–Ω–∞—è.

### 4.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ fallback-–ª–æ–≥–∏–∫–∏ –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- Fallback –Ω–∞ `setCenter()` –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ç–∏–ø–∞—Ö (—Å—Ç—Ä–æ–∫–∏ 214-218)
- Fallback –Ω–∞ `setCenter()` –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 231-235)
- Fallback –Ω–∞ `setCenter()` –ø—Ä–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏—Ö bounds (—Å—Ç—Ä–æ–∫–∏ 273-277)
- Fallback –≤ catch –±–ª–æ–∫–µ (—Å—Ç—Ä–æ–∫–∏ 290-297)
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

**–í—ã–≤–æ–¥:** Fallback-–ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.

### 4.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∑–æ–≤–∞ fitBounds —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isMapReady` (—Å—Ç—Ä–æ–∫–∞ 443)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isInitialized()` (—Å—Ç—Ä–æ–∫–∞ 447)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isSizeValidated` –¥–ª—è Leaflet (—Å—Ç—Ä–æ–∫–∞ 452)
- –í–∞–ª–∏–¥–∞—Ü–∏—è bounds –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `fitBounds()` (—Å—Ç—Ä–æ–∫–∏ 191-278)

**–í—ã–≤–æ–¥:** `fitBounds` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Ä–∞–∑–º–µ—Ä—ã –∫–∞—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.

### 4.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ª–∏—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤ fitBounds

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö bounds —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ (—Å—Ç—Ä–æ–∫–∏ 457-467)
- –ü—Ä–æ–ø—É—Å–∫ –≤—ã–∑–æ–≤–∞, –µ—Å–ª–∏ bounds –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å (—Å—Ç—Ä–æ–∫–∏ 464-467)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `previousBoundsRef` –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ (—Å—Ç—Ä–æ–∫–∞ 470)

**–í—ã–≤–æ–¥:** –õ–∏—à–Ω–∏–µ –≤—ã–∑–æ–≤—ã `fitBounds` –∏—Å–∫–ª—é—á–µ–Ω—ã.

### 4.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ previousBounds

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `previousBoundsRef` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `useRef<IMapBounds | null>(null)` (—Å—Ç—Ä–æ–∫–∞ 106)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∑–Ω–∞—á–µ–Ω–∏–π bounds (—Å—Ç—Ä–æ–∫–∏ 459-463)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (—Å—Ç—Ä–æ–∫–∞ 470)
- –°–±—Ä–æ—Å –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ (—Å—Ç—Ä–æ–∫–∞ 437)

**–í—ã–≤–æ–¥:** `previousBounds` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 4.6 –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–∑–æ–≤–∞ setBounds –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `mapProviderRef.current` (—Å—Ç—Ä–æ–∫–∞ 443)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isMapReady` (—Å—Ç—Ä–æ–∫–∞ 443)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isInitialized()` (—Å—Ç—Ä–æ–∫–∞ 447)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isSizeValidated` –¥–ª—è Leaflet (—Å—Ç—Ä–æ–∫–∞ 452)
- –í–∞–ª–∏–¥–∞—Ü–∏—è bounds –≤ –º–µ—Ç–æ–¥–µ `setBounds()` (—Å—Ç—Ä–æ–∫–∏ 185-188)

**–í—ã–≤–æ–¥:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å `setBounds` –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã.

### –ò—Ç–æ–≥ –ø–æ setBounds

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 5. –ü–†–û–í–ï–†–ö–ê –†–ï–ù–î–ï–†–ò–ù–ì–ê –ü–û–õ–ò–õ–ò–ù–ò–ô

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 493-530

**–§–∞–π–ª:** `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`  
**–°—Ç—Ä–æ–∫–∏:** 436-484

### 5.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–∑–æ–≤–æ–≤: –∫–∞—Ä—Ç–∞ ‚Üí polylines

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ü–æ—Ä—è–¥–æ–∫:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã (—Å—Ç—Ä–æ–∫–∏ 500-502)
2. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø–æ–ª–∏–ª–∏–Ω–∏–π (—Å—Ç—Ä–æ–∫–∏ 507-510)
3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–∏–ª–∏–Ω–∏–π (—Å—Ç—Ä–æ–∫–∏ 513-528)

**–í—ã–≤–æ–¥:** –ü–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.

### 5.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è polyline —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isMapReady` (—Å—Ç—Ä–æ–∫–∞ 500)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isInitialized()` (—Å—Ç—Ä–æ–∫–∞ 500)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `mapProviderRef.current` (—Å—Ç—Ä–æ–∫–∞ 495)

**–í—ã–≤–æ–¥:** –ü–æ–ª–∏–ª–∏–Ω–∏–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã.

### 5.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ê–Ω–∞–ª–∏–∑:**
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∞: `[visibleSegments, selectedSegmentId, isMapReady]` (—Å—Ç—Ä–æ–∫–∞ 530)
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø–æ–ª–∏–ª–∏–Ω–∏–π –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö (—Å—Ç—Ä–æ–∫–∏ 507-510)
- –≠—Ñ—Ñ–µ–∫—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–í—ã–≤–æ–¥:** –ü–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –Ω–µ—Ç. –ü–æ–ª–∏–ª–∏–Ω–∏–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤.

### –ò—Ç–æ–≥ –ø–æ –ø–æ–ª–∏–ª–∏–Ω–∏—è–º

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 6. –ü–†–û–í–ï–†–ö–ê –†–ï–ù–î–ï–†–ò–ù–ì–ê –ú–ê–†–ö–ï–†–û–í

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 532-569

**–§–∞–π–ª:** `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`  
**–°—Ç—Ä–æ–∫–∏:** 338-394

### 6.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã (—Å—Ç—Ä–æ–∫–∏ 539-541)
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö (—Å—Ç—Ä–æ–∫–∏ 546-549)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ `generateMapMarkers` (—Å—Ç—Ä–æ–∫–∞ 552)
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç—É (—Å—Ç—Ä–æ–∫–∏ 555-567)

**–í—ã–≤–æ–¥:** –ú–∞—Ä–∫–µ—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 6.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ zIndexOffset –¥–ª—è transfer-–º–∞—Ä–∫–µ—Ä–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `zIndexOffset: 1000` –≤ –æ–ø—Ü–∏—è—Ö –∏–∫–æ–Ω–∫–∏ –¥–ª—è transfer –º–∞—Ä–∫–µ—Ä–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 365)
- `zIndexOffset: 1000` –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–∞—Ä–∫–µ—Ä–∞ –¥–ª—è transfer —Ç–æ—á–µ–∫ (—Å—Ç—Ä–æ–∫–∞ 372)
- –û–±—ã—á–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –∏–º–µ—é—Ç `zIndexOffset: 0` –∏–ª–∏ `undefined`

**–í—ã–≤–æ–¥:** zIndexOffset –¥–ª—è transfer-–º–∞—Ä–∫–µ—Ä–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 6.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∏–∫–æ–Ω–æ–∫ –∏ –∏—Ö –æ–ø—Ü–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∏–∫–æ–Ω–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (—Å—Ç—Ä–æ–∫–∞ 558)
- –ü–µ—Ä–µ–¥–∞—á–∞ `isTransfer` –≤ –æ–ø—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 559)
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–ø—Ü–∏–π –∏–∫–æ–Ω–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 355-366)

**–í—ã–≤–æ–¥:** –ò–∫–æ–Ω–∫–∏ –∏ –∏—Ö –æ–ø—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 6.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isMapReady` (—Å—Ç—Ä–æ–∫–∞ 539)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isInitialized()` (—Å—Ç—Ä–æ–∫–∞ 539)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `mapProviderRef.current` (—Å—Ç—Ä–æ–∫–∞ 534)

**–í—ã–≤–æ–¥:** –ú–∞—Ä–∫–µ—Ä—ã –Ω–µ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã.

### –ò—Ç–æ–≥ –ø–æ –º–∞—Ä–∫–µ—Ä–∞–º

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 7. –ü–†–û–í–ï–†–ö–ê –í–°–ï–ô –¶–ï–ü–û–ß–ö–ò –ö–û–ú–ü–û–ù–ï–ù–¢–û–í

**–¶–µ–ø–æ—á–∫–∞:**
```
RouteDetailsView (—Å—Ç—Ä–æ–∫–∞ 136)
  ‚Üí RouteMapWithAlternatives (—Å—Ç—Ä–æ–∫–∏ 60-165)
    ‚Üí RouteMapSwitcher (—Å—Ç—Ä–æ–∫–∏ 58-184)
      ‚Üí RouteMap (—Å—Ç—Ä–æ–∫–∏ 89-725)
        ‚Üí LeafletMapProvider (—Å—Ç—Ä–æ–∫–∏ 57-741)
```

### 7.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏ providerType

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–¶–µ–ø–æ—á–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏:**
1. `RouteDetailsView` ‚Üí `RouteMapWithAlternatives`: `providerType="leaflet"` (—Å—Ç—Ä–æ–∫–∞ 136)
2. `RouteMapWithAlternatives` ‚Üí `RouteMapSwitcher`: `providerType={providerType}` (—Å—Ç—Ä–æ–∫–∞ 162)
3. `RouteMapSwitcher` ‚Üí `RouteMap`: `providerType={providerType}` (—Å—Ç—Ä–æ–∫–∞ 171)
4. `RouteMap` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `providerType` –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (—Å—Ç—Ä–æ–∫–∏ 216-226)

**–í—ã–≤–æ–¥:** `providerType` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–µ.

### 7.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ key –≤ RouteMapSwitcher

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- Key –≤–∫–ª—é—á–∞–µ—Ç `providerType`, `currentRoute.routeId` –∏ `currentRouteIndex` (—Å—Ç—Ä–æ–∫–∞ 172)
- –ü—Ä–∏ `preserveMapPosition === true` key —Å—Ç–∞–±–∏–ª–µ–Ω: `'preserve'`
- –ü—Ä–∏ `preserveMapPosition === false` key —É–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞

**–í—ã–≤–æ–¥:** Key –≤ RouteMapSwitcher –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.

### 7.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ preserveMapPosition

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `preserveMapPosition` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –ø–æ —Ü–µ–ø–æ—á–∫–µ (—Å—Ç—Ä–æ–∫–∏ 161, 64)
- Key –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `preserveMapPosition` (—Å—Ç—Ä–æ–∫–∞ 172)
- –ü—Ä–∏ `preserveMapPosition === true` –∫–∞—Ä—Ç–∞ –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è

**–í—ã–≤–æ–¥:** `preserveMapPosition` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ.

### 7.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ª–∏—à–Ω–∏—Ö —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ê–Ω–∞–ª–∏–∑:**
- `mapProvider` –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `useMemo` (—Å—Ç—Ä–æ–∫–∏ 216-226)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã: `[externalMapProvider, providerType]`
- Key —Å—Ç–∞–±–∏–ª–µ–Ω –ø—Ä–∏ `preserveMapPosition === true`
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `RouteMapSwitcher` –æ–±—ë—Ä–Ω—É—Ç –≤ `memo` (—Å—Ç—Ä–æ–∫–∞ 58)

**–í—ã–≤–æ–¥:** –õ–∏—à–Ω–∏—Ö —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–π –Ω–µ—Ç.

### 7.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —É—Ç–µ—á–µ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –º–∞—Ä—à—Ä—É—Ç–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 414-437)
- –û—á–∏—Å—Ç–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –ø–æ–ª–∏–ª–∏–Ω–∏–π –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö (—Å—Ç—Ä–æ–∫–∏ 507-510, 546-549)
- –°–±—Ä–æ—Å `previousBoundsRef` –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ (—Å—Ç—Ä–æ–∫–∞ 437)
- –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 429-431)

**–í—ã–≤–æ–¥:** –£—Ç–µ—á–µ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –º–∞—Ä—à—Ä—É—Ç–∞–º–∏ –Ω–µ—Ç.

### –ò—Ç–æ–≥ –ø–æ —Ü–µ–ø–æ—á–∫–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 8. –ü–†–û–í–ï–†–ö–ê –û–ë–†–ê–ë–û–¢–ö–ò –û–®–ò–ë–û–ö

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 616-656

### 8.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ initError

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –û—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `initError` (—Å—Ç—Ä–æ–∫–∞ 109)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 280-282, 313-315, 384-385)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ UI (—Å—Ç—Ä–æ–∫–∏ 622-623)

**–í—ã–≤–æ–¥:** `initError` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 8.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –æ—à–∏–±–∫–∏ (—Å—Ç—Ä–æ–∫–∞ 622)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ (—Å—Ç—Ä–æ–∫–∞ 623)
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞" (—Å—Ç—Ä–æ–∫–∏ 624-640)

**–í—ã–≤–æ–¥:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

### 8.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞"

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –°–±—Ä–æ—Å `initError` (—Å—Ç—Ä–æ–∫–∞ 626)
- –°–±—Ä–æ—Å `isMapReady` (—Å—Ç—Ä–æ–∫–∞ 627)
- –°–±—Ä–æ—Å `isSizeValidated` (—Å—Ç—Ä–æ–∫–∞ 628)
- –°–±—Ä–æ—Å `isLeafletCssLoaded` (—Å—Ç—Ä–æ–∫–∞ 630)
- –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã (—Å—Ç—Ä–æ–∫–∏ 632-635)
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–í—ã–≤–æ–¥:** –ö–Ω–æ–ø–∫–∞ "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞" –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å—é —Ü–µ–ø–æ—á–∫—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### 8.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –æ—à–∏–±–æ–∫

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ CSS (—Å—Ç—Ä–æ–∫–∞ 282)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (—Å—Ç—Ä–æ–∫–∞ 315)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã (—Å—Ç—Ä–æ–∫–∏ 386-396)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ `setBounds()` (—Å—Ç—Ä–æ–∫–∏ 208-213, 223-230, 269-272, 284-289)

**–í—ã–≤–æ–¥:** –í—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.

### 8.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ª–∞–≤–ª–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫ Leaflet

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- Try-catch –≤ –º–µ—Ç–æ–¥–µ `initialize()` (—Å—Ç—Ä–æ–∫–∏ 156-165)
- Try-catch –≤ –º–µ—Ç–æ–¥–µ `setBounds()` (—Å—Ç—Ä–æ–∫–∏ 283-298)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª—è Leaflet (—Å—Ç—Ä–æ–∫–∏ 167-176)
- Fallback –Ω–∞ `setCenter()` –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–í—ã–≤–æ–¥:** –û—à–∏–±–∫–∏ Leaflet –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—é—Ç—Å—è.

### 8.6 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤ –∫–æ–Ω—Å–æ–ª–∏

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è**

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
- `console.log` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 339-346, 359-363)
- `console.warn` –¥–ª—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö bounds (—Å—Ç—Ä–æ–∫–∏ 186, 192, 208, 223, 269)
- `console.error` –¥–ª—è –æ—à–∏–±–æ–∫ (—Å—Ç—Ä–æ–∫–∏ 282, 315, 386-396, 284-289, 296)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å `console.log` –∏–ª–∏ –æ–±–µ—Ä–Ω—É—Ç—å –∏—Ö –≤ —É—Å–ª–æ–≤–∏–µ `process.env.NODE_ENV === 'development'`. `console.warn` –∏ `console.error` –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ **–ù–∏–∑–∫–∏–π**

### –ò—Ç–æ–≥ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç** (–∫—Ä–æ–º–µ –Ω–∏–∑–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ console.log)

---

## 9. –ü–†–û–í–ï–†–ö–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`

### 9.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ª–∏—à–Ω–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ CSS (—Å—Ç—Ä–æ–∫–∏ 164-213): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `[providerType]` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã (—Å—Ç—Ä–æ–∫–∏ 228-439): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `[mapProvider, showControls, providerType, isLeafletCssLoaded]` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ bounds (—Å—Ç—Ä–æ–∫–∏ 441-472): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `[bounds, boundsValid, isMapReady, isSizeValidated, providerType]` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
4. –°–æ–±—ã—Ç–∏—è –∫–∞—Ä—Ç—ã (—Å—Ç—Ä–æ–∫–∏ 474-491): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `[mapEvents, isMapReady]` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
5. –ü–æ–ª–∏–ª–∏–Ω–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 493-530): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `[visibleSegments, selectedSegmentId, isMapReady]` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
6. –ú–∞—Ä–∫–µ—Ä—ã (—Å—Ç—Ä–æ–∫–∏ 532-569): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `[mapData, isMapReady]` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
7. –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 571-580): –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `[]` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

**–í—ã–≤–æ–¥:** –õ–∏—à–Ω–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –Ω–µ—Ç. –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.

### 9.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π useEffect –Ω–∞ –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–ê–Ω–∞–ª–∏–∑:**
- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- –ù–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ù–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–í—ã–≤–æ–¥:** –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ useEffect –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã.

### 9.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç—ã –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–∞–¥—ë–∂–Ω–æ**

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `mapProvider` –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `useMemo` (—Å—Ç—Ä–æ–∫–∏ 216-226)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã: `[externalMapProvider, providerType]`
- –ü—Ä–∏ `preserveMapPosition === true` key —Å—Ç–∞–±–∏–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `isMapReady && this.map` –≤ `initialize()` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é (—Å—Ç—Ä–æ–∫–∞ 76-78 –≤ LeafletMapProvider)

**–í—ã–≤–æ–¥:** –ö–∞—Ä—Ç–∞ –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

### –ò—Ç–æ–≥ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü—Ä–æ–±–ª–µ–º –Ω–µ—Ç**

---

## 10. –ò–¢–û–ì–û–í–´–ô –û–¢–ß–Å–¢

### 10.1 –°—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª—è

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** ‚úÖ **–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –Ω–∞ 100%**

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 0
- üü† **–í—ã—Å–æ–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 0
- üü° **–°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 0
- üü¢ **–ù–∏–∑–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** 2

### 10.2 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º**

### 10.3 –í—ã—Å–æ–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–µ—Ç –≤—ã—Å–æ–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º**

### 10.4 –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–µ—Ç —Å—Ä–µ–¥–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º**

### 10.5 –ù–∏–∑–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

#### –ü—Ä–æ–±–ª–µ–º–∞ #1: console.log –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–§–∞–π–ª:** `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`  
**–°—Ç—Ä–æ–∫–∏:** 339-346, 359-363

**–§–∞–π–ª:** `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`  
**–°—Ç—Ä–æ–∫–∏:** 82, 86, 106-110, 150-154

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ `console.log` –æ—Å—Ç–∞–ª–∏—Å—å –≤ –∫–æ–¥–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

**–ß—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É:** –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —ç—Ç–∏ –ª–æ–≥–∏ –º–æ–≥—É—Ç –∑–∞—Å–æ—Ä—è—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞.

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:** –û–±–µ—Ä–Ω—É—Ç—å `console.log` –≤ —É—Å–ª–æ–≤–∏–µ `process.env.NODE_ENV === 'development'` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –∏—Ö. `console.warn` –∏ `console.error` –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ **–ù–∏–∑–∫–∏–π**

**–í–ª–∏—è–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ. –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Ç–æ–ª—å–∫–æ –Ω–∞ —á–∏—Å—Ç–æ—Ç—É –∫–æ–Ω—Å–æ–ª–∏.

---

#### –ü—Ä–æ–±–ª–µ–º–∞ #2: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –¥–≤–æ–π–Ω–æ–π –≤—ã–∑–æ–≤ setBounds –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ bounds –≤ initialize()

**–§–∞–π–ª:** `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`  
**–°—Ç—Ä–æ–∫–∏:** 142-149

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –í –º–µ—Ç–æ–¥–µ `initialize()` –µ—Å—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç bounds, –µ—Å–ª–∏ –æ–Ω–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ `options.bounds`. –í —Ç–æ –∂–µ –≤—Ä–µ–º—è, –≤ `route-map.tsx` bounds —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç.

**–ß—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É:** –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –∫—Ç–æ-—Ç–æ –ø–µ—Ä–µ–¥–∞—Å—Ç bounds –≤ `initialize()`, –æ–Ω–∏ –±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–≤–∞–∂–¥—ã - –æ–¥–∏–Ω —Ä–∞–∑ –∏–∑ `initialize()`, –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞ `setBounds` –≤ `route-map.tsx`.

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:** –õ–∏–±–æ —É–±—Ä–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É bounds –∏–∑ `initialize()` –¥–ª—è Leaflet (—Ç–∞–∫ –∫–∞–∫ bounds —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —ç—Ñ—Ñ–µ–∫—Ç), –ª–∏–±–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ–±—ã –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å bounds –¥–≤–∞–∂–¥—ã. –û–¥–Ω–∞–∫–æ —Å–µ–π—á–∞—Å —ç—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞, —Ç–∞–∫ –∫–∞–∫ bounds –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `initialize()`.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ **–ù–∏–∑–∫–∏–π**

**–í–ª–∏—è–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ. –°–µ–π—á–∞—Å –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Ç–∞–∫ –∫–∞–∫ bounds –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `initialize()`. –≠—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞ –±—É–¥—É—â–µ–µ.

### 10.6 –ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** –ù–µ—Ç

**–í—ã—Å–æ–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** –ù–µ—Ç

**–°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:** –ù–µ—Ç

**–ù–∏–∑–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ –æ—Å—Ç–∞–ª–∏—Å—å –≤ –∫–æ–¥–µ
2. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –¥–≤–æ–π–Ω–æ–π –≤—ã–∑–æ–≤ setBounds –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ bounds –≤ initialize() (–Ω–µ –≤–ª–∏—è–µ—Ç —Å–µ–π—á–∞—Å, —Ç–∞–∫ –∫–∞–∫ bounds –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è)

### 10.7 –¢–æ—á–Ω—ã–µ –º–µ—Å—Ç–∞ –≤ —Ñ–∞–π–ª–∞—Ö

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #1:**
- `frontend/src/modules/routes/features/route-map/ui/route-map.tsx`: —Å—Ç—Ä–æ–∫–∏ 339-346, 359-363
- `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`: —Å—Ç—Ä–æ–∫–∏ 82, 86, 106-110, 150-154

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #2:**
- `frontend/src/modules/routes/lib/providers/leaflet-map-provider.ts`: —Å—Ç—Ä–æ–∫–∏ 142-149

### 10.8 –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #1:** –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ `console.log` –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #2:** –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º bounds –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ `initialize()`, –æ–Ω–∏ –±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–≤–∞–∂–¥—ã - –æ–¥–∏–Ω —Ä–∞–∑ –∏–∑ `initialize()`, –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞ `setBounds`.

### 10.9 –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #1:** –û–±–µ—Ä–Ω—É—Ç—å `console.log` –≤ —É—Å–ª–æ–≤–∏–µ `process.env.NODE_ENV === 'development'` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –∏—Ö.

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #2:** –õ–∏–±–æ —É–±—Ä–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É bounds –∏–∑ `initialize()` –¥–ª—è Leaflet (—Ç–∞–∫ –∫–∞–∫ bounds —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —ç—Ñ—Ñ–µ–∫—Ç), –ª–∏–±–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ–±—ã –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å bounds –¥–≤–∞–∂–¥—ã. –û–¥–Ω–∞–∫–æ —Å–µ–π—á–∞—Å —ç—Ç–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ bounds –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `initialize()`.

### 10.10 –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #1:** üü¢ **–ù–∏–∑–∫–∏–π** (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏)

**–ù–∏–∑–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ #2:** üü¢ **–ù–∏–∑–∫–∏–π** (–Ω–µ –≤–ª–∏—è–µ—Ç —Å–µ–π—á–∞—Å, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞ –±—É–¥—É—â–µ–µ)

---

## 11. –û–ë–©–ò–ô –í–´–í–û–î –û –ì–û–¢–û–í–ù–û–°–¢–ò –ö –ü–†–û–î–ê–ö–®–ï–ù–£

### 11.1 –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–°—Ç–∞—Ç—É—Å –º–æ–¥—É–ª—è:** ‚úÖ **–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –Ω–∞ 100%**

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, –≤—ã—Å–æ–∫–∏–µ –∏ —Å—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã.**

### 11.2 –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –º–æ–¥—É–ª—è

‚úÖ **–ù–∞–¥—ë–∂–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CSS** ‚Äî –Ω–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, –Ω–µ—Ç –≥–æ–Ω–æ–∫, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö  
‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏  
‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è invalidateSize –∏ setBounds** ‚Äî –Ω–µ—Ç –≥–æ–Ω–æ–∫, —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è  
‚úÖ **–ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è bounds** ‚Äî –≤—Å–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å fallback  
‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã–∑–æ–≤–æ–≤** ‚Äî –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤ `fitBounds()`  
‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** ‚Äî –ø–æ–ª–∏–ª–∏–Ω–∏–∏ –∏ –º–∞—Ä–∫–µ—Ä—ã —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã  
‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ props, —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏, –Ω–µ—Ç —É—Ç–µ—á–µ–∫  
‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** ‚Äî –≤—Å–µ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å  
‚úÖ **–û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –Ω–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç—ã

### 11.3 –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–ü–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º:**
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–±—Ä–∞—Ç—å –∏–ª–∏ –æ–±–µ—Ä–Ω—É—Ç—å `console.log` –≤ —É—Å–ª–æ–≤–∏–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

**–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
- –ú–æ–¥—É–ª—å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏ –≤—ã—Å–æ–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- –ú–æ–¥—É–ª—å —Å—Ç–∞–±–∏–ª–µ–Ω –∏ –Ω–∞–¥—ë–∂–µ–Ω

### 11.4 –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

**–ú–æ–¥—É–ª—å Leaflet-–∫–∞—Ä—Ç—ã:**
- ‚úÖ –°—Ç–∞–±–∏–ª–µ–Ω –Ω–∞ 100%
- ‚úÖ –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –í—Å–µ –≤—ã—Å–æ–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –í—Å–µ —Å—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –ù–∏–∑–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

---

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê—É–¥–∏—Ç –∑–∞–≤–µ—Ä—à—ë–Ω  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 100%

